cc.CONTROL_EVENT_TOTAL_NUMBER=9,cc.CONTROL_EVENT_TOUCH_DOWN=1,cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE=2,cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE=4,cc.CONTROL_EVENT_TOUCH_DRAG_ENTER=8,cc.CONTROL_EVENT_TOUCH_DRAG_EXIT=16,cc.CONTROL_EVENT_TOUCH_UP_INSIDE=32,cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE=64,cc.CONTROL_EVENT_TOUCH_CANCEL=128,cc.CONTROL_EVENT_VALUECHANGED=256,cc.CONTROL_STATE_NORMAL=1,cc.CONTROL_STATE_HIGHLIGHTED=2,cc.CONTROL_STATE_DISABLED=4,cc.CONTROL_STATE_SELECTED=8,cc.CONTROL_STATE_INITIAL=8,cc.Control=cc.Layer.extend({_isOpacityModifyRGB:!1,_hasVisibleParents:!1,_touchListener:null,_className:"Control",isOpacityModifyRGB:function(){return this._isOpacityModifyRGB},setOpacityModifyRGB:function(opacityModifyRGB){this._isOpacityModifyRGB=opacityModifyRGB;for(var children=this.getChildren(),i=0,len=children.length;i<len;i++){var selNode=children[i];selNode&&selNode.setOpacityModifyRGB(opacityModifyRGB)}},_state:cc.CONTROL_STATE_NORMAL,getState:function(){return this._state},_enabled:!1,_selected:!1,_highlighted:!1,_dispatchTable:null,setEnabled:function(enabled){this._enabled=enabled,this._state=enabled?cc.CONTROL_STATE_NORMAL:cc.CONTROL_STATE_DISABLED,this.needsLayout()},isEnabled:function(){return this._enabled},setSelected:function(selected){this._selected=selected,this.needsLayout()},isSelected:function(){return this._selected},setHighlighted:function(highlighted){this._highlighted=highlighted,this.needsLayout()},isHighlighted:function(){return this._highlighted},hasVisibleParents:function(){for(var c=this.getParent();null!=c;c=c.getParent())if(!c.isVisible())return!1;return!0},ctor:function(){cc.Layer.prototype.ctor.call(this),this._dispatchTable={},this._color=cc.color.WHITE},init:function(){this._state=cc.CONTROL_STATE_NORMAL,this._enabled=!0,this._selected=!1,this._highlighted=!1;var listener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0});return this.onTouchBegan&&(listener.onTouchBegan=this.onTouchBegan.bind(this)),this.onTouchMoved&&(listener.onTouchMoved=this.onTouchMoved.bind(this)),this.onTouchEnded&&(listener.onTouchEnded=this.onTouchEnded.bind(this)),this.onTouchCancelled&&(listener.onTouchCancelled=this.onTouchCancelled.bind(this)),this._touchListener=listener,!0},onEnter:function(){var locListener=this._touchListener;locListener._isRegistered()||cc.eventManager.addListener(locListener,this),cc.Node.prototype.onEnter.call(this)},sendActionsForControlEvents:function(controlEvents){for(var i=0,len=cc.CONTROL_EVENT_TOTAL_NUMBER;i<len;i++)if(controlEvents&1<<i)for(var invocationList=this._dispatchListforControlEvent(1<<i),j=0,inLen=invocationList.length;j<inLen;j++)invocationList[j].invoke(this)},addTargetWithActionForControlEvents:function(target,action,controlEvents){for(var i=0,len=cc.CONTROL_EVENT_TOTAL_NUMBER;i<len;i++)controlEvents&1<<i&&this._addTargetWithActionForControlEvent(target,action,1<<i)},removeTargetWithActionForControlEvents:function(target,action,controlEvents){for(var i=0,len=cc.CONTROL_EVENT_TOTAL_NUMBER;i<len;i++)controlEvents&1<<i&&this._removeTargetWithActionForControlEvent(target,action,1<<i)},getTouchLocation:function(touch){var touchLocation=touch.getLocation();return this.convertToNodeSpace(touchLocation)},isTouchInside:function(touch){var touchLocation=touch.getLocation();return touchLocation=this.getParent().convertToNodeSpace(touchLocation),cc.rectContainsPoint(this.getBoundingBox(),touchLocation)},_invocationWithTargetAndActionForControlEvent:function(target,action,controlEvent){return null},_dispatchListforControlEvent:function(controlEvent){return controlEvent=controlEvent.toString(),this._dispatchTable[controlEvent]||(this._dispatchTable[controlEvent]=[]),this._dispatchTable[controlEvent]},_addTargetWithActionForControlEvent:function(target,action,controlEvent){var invocation=new cc.Invocation(target,action,controlEvent);this._dispatchListforControlEvent(controlEvent).push(invocation)},_removeTargetWithActionForControlEvent:function(target,action,controlEvent){var eventInvocationList=this._dispatchListforControlEvent(controlEvent);if(target||action)for(var i=0;i<eventInvocationList.length;){var invocation=eventInvocationList[i],shouldBeRemoved=!0;target&&(shouldBeRemoved=target===invocation.getTarget()),action&&(shouldBeRemoved=shouldBeRemoved&&action===invocation.getAction()),shouldBeRemoved?cc.arrayRemoveObject(eventInvocationList,invocation):i++}else eventInvocationList.length=0},needsLayout:function(){}}),(_p=cc.Control.prototype).state,cc.defineGetterSetter(_p,"state",_p.getState),_p.enabled,cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled),_p.selected,cc.defineGetterSetter(_p,"selected",_p.isSelected,_p.setSelected),_p.highlighted,cc.defineGetterSetter(_p,"highlighted",_p.isHighlighted,_p.setHighlighted),_p=null,cc.Control.create=function(){var retControl=new cc.Control;return retControl&&retControl.init()?retControl:null},cc.CONTROL_ZOOM_ACTION_TAG=3435855873,cc.ControlButton=cc.Control.extend({_doesAdjustBackgroundImage:!1,zoomOnTouchDown:!1,_preferredSize:null,_labelAnchorPoint:null,_currentTitle:null,_currentTitleColor:null,_titleLabel:null,_backgroundSprite:null,_opacity:0,_isPushed:!1,_titleDispatchTable:null,_titleColorDispatchTable:null,_titleLabelDispatchTable:null,_backgroundSpriteDispatchTable:null,_parentInited:!1,_marginV:0,_marginH:0,_className:"ControlButton",ctor:function(label,backgroundSprite,fontSize){cc.Control.prototype.ctor.call(this),this._preferredSize=cc.size(0,0),this._labelAnchorPoint=cc.p(0,0),this._currentTitle="",this._currentTitleColor=cc.color.WHITE,this._titleDispatchTable={},this._titleColorDispatchTable={},this._titleLabelDispatchTable={},this._backgroundSpriteDispatchTable={},null!=fontSize?this.initWithTitleAndFontNameAndFontSize(label,backgroundSprite,fontSize):null!=backgroundSprite?this.initWithLabelAndBackgroundSprite(label,backgroundSprite):null!=label?this.initWithBackgroundSprite(label):this.init()},init:function(){return this.initWithLabelAndBackgroundSprite(new cc.LabelTTF("","Arial",12),new cc.Scale9Sprite)},needsLayout:function(){if(this._parentInited){this._titleLabel&&this._titleLabel.setVisible(!1),this._backgroundSprite&&this._backgroundSprite.setVisible(!1),this.setLabelAnchorPoint(this._labelAnchorPoint);var locState=this._state;this._currentTitle=this.getTitleForState(locState),this._currentTitleColor=this.getTitleColorForState(locState),this._titleLabel=this.getTitleLabelForState(locState);var label=this._titleLabel;label&&label.setString&&label.setString(this._currentTitle),label&&label.setColor(this._currentTitleColor);var locContentSize=this.getContentSize();label&&label.setPosition(locContentSize.width/2,locContentSize.height/2),this._backgroundSprite=this.getBackgroundSpriteForState(locState);var locBackgroundSprite=this._backgroundSprite;locBackgroundSprite&&locBackgroundSprite.setPosition(locContentSize.width/2,locContentSize.height/2);var titleLabelSize=cc.size(0,0);if(label){var boundingBox=label.getBoundingBox();titleLabelSize.width=boundingBox.width,titleLabelSize.height=boundingBox.height}if(this._doesAdjustBackgroundImage)locBackgroundSprite&&locBackgroundSprite.setContentSize(titleLabelSize.width+2*this._marginH,titleLabelSize.height+2*this._marginV);else if(locBackgroundSprite){var preferredSize=locBackgroundSprite.getPreferredSize();(preferredSize=cc.size(preferredSize.width,preferredSize.height)).width<=0&&(preferredSize.width=titleLabelSize.width),preferredSize.height<=0&&(preferredSize.height=titleLabelSize.height),locBackgroundSprite.setContentSize(preferredSize)}var rectTitle=label?label.getBoundingBox():cc.rect(0,0,0,0),rectBackground=locBackgroundSprite?locBackgroundSprite.getBoundingBox():cc.rect(0,0,0,0),maxRect=cc.rectUnion(rectTitle,rectBackground);this.setContentSize(maxRect.width,maxRect.height),locContentSize=this.getContentSize(),label&&(label.setPosition(locContentSize.width/2,locContentSize.height/2),label.setVisible(!0)),locBackgroundSprite&&(locBackgroundSprite.setPosition(locContentSize.width/2,locContentSize.height/2),locBackgroundSprite.setVisible(!0))}},initWithLabelAndBackgroundSprite:function(label,backgroundSprite){if(!label)throw new Error("cc.ControlButton.initWithLabelAndBackgroundSprite(): label should be non-null");if(!backgroundSprite)throw new Error("cc.ControlButton.initWithLabelAndBackgroundSprite(): backgroundSprite should be non-null");if(cc.Control.prototype.init.call(this,!0)){this._parentInited=!0,this._titleDispatchTable={},this._titleColorDispatchTable={},this._titleLabelDispatchTable={},this._backgroundSpriteDispatchTable={},this._isPushed=!1,this.zoomOnTouchDown=!0,this._currentTitle=null,this.setAdjustBackgroundImage(!0),this.setPreferredSize(cc.size(0,0)),this.zoomOnTouchDown=!0,this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(.5,.5),this._titleLabel=label,this._backgroundSprite=backgroundSprite,this.setOpacity(255),this.setOpacityModifyRGB(!0);var tempString=label.getString();return this.setTitleForState(tempString,cc.CONTROL_STATE_NORMAL),this.setTitleColorForState(label.getColor(),cc.CONTROL_STATE_NORMAL),this.setTitleLabelForState(label,cc.CONTROL_STATE_NORMAL),this.setBackgroundSpriteForState(backgroundSprite,cc.CONTROL_STATE_NORMAL),this._state=cc.CONTROL_STATE_NORMAL,this._marginH=24,this._marginV=12,this._labelAnchorPoint=cc.p(.5,.5),this.setPreferredSize(cc.size(0,0)),this.needsLayout(),!0}return!1},initWithTitleAndFontNameAndFontSize:function(title,fontName,fontSize){var label=new cc.LabelTTF(title,fontName,fontSize);return this.initWithLabelAndBackgroundSprite(label,new cc.Scale9Sprite)},initWithBackgroundSprite:function(sprite){var label=new cc.LabelTTF("","Arial",30);return this.initWithLabelAndBackgroundSprite(label,sprite)},doesAdjustBackgroundImage:function(){return this._doesAdjustBackgroundImage},setAdjustBackgroundImage:function(adjustBackgroundImage){this._doesAdjustBackgroundImage=adjustBackgroundImage,this.needsLayout()},getZoomOnTouchDown:function(){return this.zoomOnTouchDown},setZoomOnTouchDown:function(zoomOnTouchDown){return this.zoomOnTouchDown=zoomOnTouchDown},getPreferredSize:function(){return this._preferredSize},setPreferredSize:function(size){if(0===size.width&&0===size.height)this._doesAdjustBackgroundImage=!0;else{this._doesAdjustBackgroundImage=!1;var locTable=this._backgroundSpriteDispatchTable;for(var itemKey in locTable)locTable[itemKey].setPreferredSize(size)}this._preferredSize=size,this.needsLayout()},getLabelAnchorPoint:function(){return this._labelAnchorPoint},setLabelAnchorPoint:function(labelAnchorPoint){this._labelAnchorPoint=labelAnchorPoint,this._titleLabel&&this._titleLabel.setAnchorPoint(labelAnchorPoint)},_getCurrentTitle:function(){return this._currentTitle},_getCurrentTitleColor:function(){return this._currentTitleColor},getOpacity:function(){return this._opacity},setOpacity:function(opacity){cc.Control.prototype.setOpacity.call(this,opacity);var locTable=this._backgroundSpriteDispatchTable;for(var itemKey in locTable)locTable[itemKey].setOpacity(opacity)},setColor:function(color){cc.Control.prototype.setColor.call(this,color);var locTable=this._backgroundSpriteDispatchTable;for(var key in locTable)locTable[key].setColor(color)},getColor:function(){var locRealColor=this._realColor;return cc.color(locRealColor.r,locRealColor.g,locRealColor.b,locRealColor.a)},isPushed:function(){return this._isPushed},_getVerticalMargin:function(){return this._marginV},_getHorizontalOrigin:function(){return this._marginH},setMargins:function(marginH,marginV){this._marginV=marginV,this._marginH=marginH,this.needsLayout()},setEnabled:function(enabled){cc.Control.prototype.setEnabled.call(this,enabled),this.needsLayout()},setSelected:function(enabled){cc.Control.prototype.setSelected.call(this,enabled),this.needsLayout()},setHighlighted:function(enabled){this._state=enabled?cc.CONTROL_STATE_HIGHLIGHTED:cc.CONTROL_STATE_NORMAL,cc.Control.prototype.setHighlighted.call(this,enabled);var action=this.getActionByTag(cc.CONTROL_ZOOM_ACTION_TAG);if(action&&this.stopAction(action),this.zoomOnTouchDown){var scaleValue=this.isHighlighted()&&this.isEnabled()&&!this.isSelected()?1.1:1,zoomAction=cc.scaleTo(.05,scaleValue);zoomAction.setTag(cc.CONTROL_ZOOM_ACTION_TAG),this.runAction(zoomAction)}},onTouchBegan:function(touch,event){return!!(this.isTouchInside(touch)&&this.isEnabled()&&this.isVisible()&&this.hasVisibleParents())&&(this._isPushed=!0,this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DOWN),!0)},onTouchMoved:function(touch,event){if(this._enabled&&this._isPushed&&!this._selected){var isTouchMoveInside=this.isTouchInside(touch);isTouchMoveInside&&!this._highlighted?(this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_ENTER)):isTouchMoveInside&&this._highlighted?this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE):!isTouchMoveInside&&this._highlighted?(this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_EXIT)):isTouchMoveInside||this._highlighted||this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE)}else this._highlighted&&this.setHighlighted(!1)},onTouchEnded:function(touch,event){this._isPushed=!1,this.setHighlighted(!1),this.isTouchInside(touch)?this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_UP_INSIDE):this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE)},onTouchCancelled:function(touch,event){this._isPushed=!1,this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_CANCEL)},getTitleForState:function(state){var locTable=this._titleDispatchTable;return locTable?locTable[state]?locTable[state]:locTable[cc.CONTROL_STATE_NORMAL]:""},setTitleForState:function(title,state){this._titleDispatchTable[state]=title||"",this.getState()===state&&this.needsLayout()},getTitleColorForState:function(state){var colorObject=this._titleColorDispatchTable[state];return colorObject||((colorObject=this._titleColorDispatchTable[cc.CONTROL_STATE_NORMAL])||cc.color.WHITE)},setTitleColorForState:function(color,state){this._titleColorDispatchTable[state]=color,this.getState()===state&&this.needsLayout()},getTitleLabelForState:function(state){var locTable=this._titleLabelDispatchTable;return locTable[state]?locTable[state]:locTable[cc.CONTROL_STATE_NORMAL]},setTitleLabelForState:function(titleLabel,state){var locTable=this._titleLabelDispatchTable;if(locTable[state]){var previousLabel=locTable[state];previousLabel&&this.removeChild(previousLabel,!0)}(locTable[state]=titleLabel).setVisible(!1),titleLabel.setAnchorPoint(.5,.5),this.addChild(titleLabel,1),this.getState()===state&&this.needsLayout()},setTitleTTFForState:function(fntFile,state){var title=this.getTitleForState(state);title||(title=""),this.setTitleLabelForState(new cc.LabelTTF(title,fntFile,12),state)},getTitleTTFForState:function(state){var labelTTF=this.getTitleLabelForState(state);return null!=labelTTF&&labelTTF instanceof cc.LabelTTF?labelTTF.getFontName():""},setTitleTTFSizeForState:function(size,state){var labelTTF=this.getTitleLabelForState(state);null!=labelTTF&&labelTTF instanceof cc.LabelTTF&&labelTTF.setFontSize(size)},getTitleTTFSizeForState:function(state){var labelTTF=this.getTitleLabelForState(state);return null!=labelTTF&&labelTTF instanceof cc.LabelTTF?labelTTF.getFontSize():0},setTitleBMFontForState:function(fntFile,state){var title=this.getTitleForState(state);title||(title=""),this.setTitleLabelForState(new cc.LabelBMFont(title,fntFile),state)},getTitleBMFontForState:function(state){var labelBMFont=this.getTitleLabelForState(state);return null!=labelBMFont&&labelBMFont instanceof cc.LabelBMFont?labelBMFont.getFntFile():""},getBackgroundSpriteForState:function(state){var locTable=this._backgroundSpriteDispatchTable;return locTable[state]?locTable[state]:locTable[cc.CONTROL_STATE_NORMAL]},setBackgroundSpriteForState:function(sprite,state){var locTable=this._backgroundSpriteDispatchTable;if(locTable[state]){var previousSprite=locTable[state];previousSprite&&this.removeChild(previousSprite,!0)}(locTable[state]=sprite).setVisible(!1),sprite.setAnchorPoint(.5,.5),this.addChild(sprite);var locPreferredSize=this._preferredSize;0===locPreferredSize.width&&0===locPreferredSize.height||sprite.setPreferredSize(locPreferredSize),this._state===state&&this.needsLayout()},setBackgroundSpriteFrameForState:function(spriteFrame,state){var sprite=cc.Scale9Sprite.createWithSpriteFrame(spriteFrame);this.setBackgroundSpriteForState(sprite,state)}}),(_p=cc.ControlButton.prototype).adjustBackground,cc.defineGetterSetter(_p,"adjustBackground",_p.getAdjustBackgroundImage,_p.setAdjustBackgroundImage),_p.preferredSize,cc.defineGetterSetter(_p,"preferredSize",_p.getPreferredSize,_p.setPreferredSize),_p.labelAnchor,cc.defineGetterSetter(_p,"labelAnchor",_p.getLabelAnchorPoint,_p.setLabelAnchorPoint),_p=null,cc.ControlButton.create=function(label,backgroundSprite,fontSize){return new cc.ControlButton(label,backgroundSprite,fontSize)},cc.RGBA=function(r,g,b,a){this.r=r,this.g=g,this.b=b,this.a=a},cc.HSV=function(h,s,v){this.h=h,this.s=s,this.v=v},cc.ControlUtils={},cc.ControlUtils.addSpriteToTargetWithPosAndAnchor=function(spriteName,target,pos,anchor){var sprite=new cc.Sprite("#"+spriteName);return sprite?(sprite.setPosition(pos),sprite.setAnchorPoint(anchor),target.addChild(sprite),sprite):null},cc.ControlUtils.HSVfromRGB=function(rgbaValue){var min,max,delta,out=new cc.HSV;return min=(min=rgbaValue.r<rgbaValue.g?rgbaValue.r:rgbaValue.g)<rgbaValue.b?min:rgbaValue.b,max=(max=rgbaValue.r>rgbaValue.g?rgbaValue.r:rgbaValue.g)>rgbaValue.b?max:rgbaValue.b,delta=(out.v=max)-min,0<max?(out.s=delta/max,rgbaValue.r>=max?out.h=(rgbaValue.g-rgbaValue.b)/delta:rgbaValue.g>=max?out.h=2+(rgbaValue.b-rgbaValue.r)/delta:out.h=4+(rgbaValue.r-rgbaValue.g)/delta,out.h*=60,out.h<0&&(out.h+=360)):(out.s=0,out.h=-1),out},cc.ControlUtils.RGBfromHSV=function(hsvValue){var hh,p,q,t,ff,i,out=new cc.RGBA;if(out.a=1,hsvValue.s<=0)return hsvValue.h?(out.r=0,out.g=0,out.b=0):(out.r=hsvValue.v,out.g=hsvValue.v,out.b=hsvValue.v),out;switch(360<=(hh=hsvValue.h)&&(hh=0),ff=(hh/=60)-(i=0|hh),p=hsvValue.v*(1-hsvValue.s),q=hsvValue.v*(1-hsvValue.s*ff),t=hsvValue.v*(1-hsvValue.s*(1-ff)),i){case 0:out.r=hsvValue.v,out.g=t,out.b=p;break;case 1:out.r=q,out.g=hsvValue.v,out.b=p;break;case 2:out.r=p,out.g=hsvValue.v,out.b=t;break;case 3:out.r=p,out.g=q,out.b=hsvValue.v;break;case 4:out.r=t,out.g=p,out.b=hsvValue.v;break;default:out.r=hsvValue.v,out.g=p,out.b=q}return out},cc.ControlUtils.CCRectUnion=function(rect1,rect2){return cc.rectUnion(rect1,rect2)},cc.Invocation=cc.Class.extend({_action:null,_target:null,_controlEvent:null,ctor:function(target,action,controlEvent){this._target=target,this._action=action,this._controlEvent=controlEvent},getAction:function(){return this._action},getTarget:function(){return this._target},getControlEvent:function(){return this._controlEvent},invoke:function(sender){this._target&&this._action&&(cc.isString(this._action)?this._target[this._action](sender,this._controlEvent):this._action.call(this._target,sender,this._controlEvent))}}),cc.Spacer=cc.Layer.extend({}),cc.Spacer.verticalSpacer=function(space){var pRet=new cc.Spacer;return pRet.init(),pRet.setContentSize(0,space),pRet},cc.Spacer.horizontalSpacer=function(space){var pRet=new cc.Spacer;return pRet.init(),pRet.setContentSize(space,0),pRet},cc.MenuPassive=cc.Layer.extend({_color:null,_opacity:0,_className:"MenuPassive",ctor:function(){},getColor:function(){var locColor=this._color;return cc.color(locColor.r,locColor.g,locColor.b,locColor.a)},setColor:function(color){var locColor=this._color;if(locColor.r=color.r,locColor.g=color.g,locColor.b=color.b,this._children&&0<this._children.length)for(var i=0;i<this._children.length;i++)this._children[i]&&this._children[i].setColor(color);void 0===color.a||color.a_undefined||this.setOpacity(color.a)},getOpacity:function(){return this._opacity},setOpacity:function(opacity){if(this._opacity=opacity,this._children&&0<this._children.length)for(var i=0;i<this._children.length;i++)this._children[i]&&this._children[i].setOpacity(opacity);this._color.a=opacity},initWithItems:function(item,args){if(this.init()){var winSize=cc.director.getWinSize();this.ignoreAnchorPointForPosition(!0),this.setAnchorPoint(.5,.5),this.setContentSize(winSize),this.setPosition(winSize.width/2,winSize.height/2);var z=0;if(item){this.addChild(item,z);for(var i=0;i<args.length;i++)args[i]&&(z++,this.addChild(args[i],z))}return!0}return!1},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING)},alignItemsVerticallyWithPadding:function(padding){var i,height=-padding;if(this._children&&0<this._children.length)for(i=0;i<this._children.length;i++)this._children[i]&&(height+=this._children[i].getContentSize().height*this._children[i].getScaleY()+padding);var width=0,y=height/2;if(this._children&&0<this._children.length)for(i=0;i<this._children.length;i++)this._children[i]&&(width=Math.max(width,this._children[i].getContentSize().width),this._children[i].setPosition(0,y-this._children[i].getContentSize().height*this._children[i].getScaleY()/2),y-=this._children[i].getContentSize().height*this._children[i].getScaleY()+padding);this.setContentSize(width,height)},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING)},alignItemsHorizontallyWithPadding:function(padding){var i,width=-padding;if(this._children&&0<this._children.length)for(i=0;i<this._children.length;i++)this._children[i]&&(width+=this._children[i].getContentSize().width*this._children[i].getScaleX()+padding);var height=0,x=-width/2;if(this._children&&0<this._children.length)for(i=0;i<this._children.length;i++)this._children[i]&&(height=Math.max(height,this._children[i].getContentSize().height),this._children[i].setPosition(x+this._children[i].getContentSize().width*this._children[i].getScaleX()/2,0),x+=this._children[i].getContentSize().width*this._children[i].getScaleX()+padding);this.setContentSize(width,height)},alignItemsInColumns:function(columns){var i,rows=[];for(i=1;i<arguments.length;i++)rows.push(arguments[i]);var rowColumns,tmp,height=-5,row=0,rowHeight=0,columnsOccupied=0;if(this._children&&0<this._children.length)for(i=0;i<this._children.length;i++)if(this._children[i]){if(row>=rows.length){cc.log("cc.MenuPassive.alignItemsInColumns(): invalid row index");continue}if(!(rowColumns=rows[row])){cc.log("cc.MenuPassive.alignItemsInColumns(): can not have zero columns on a row");continue}rowHeight=0|((tmp=this._children[i].getContentSize().height)<=rowHeight||null==tmp?rowHeight:tmp),rowColumns<=++columnsOccupied&&(height+=rowHeight+5,rowHeight=columnsOccupied=0,++row)}var winSize=cc.director.getWinSize(),w=rowColumns=rowHeight=row=0,x=0,y=height/2;if(this._children&&0<this._children.length)for(i=0;i<this._children.length;i++)this._children[i]&&(0===rowColumns&&(rowColumns=rows[row],x=w=winSize.width/(1+rowColumns)),rowHeight=0|((tmp=this._children[i].getContentSize().height)<=rowHeight||null==tmp?rowHeight:tmp),this._children[i].setPosition(x-winSize.width/2,y-this._children[i].getContentSize().height/2),x+=w,rowColumns<=++columnsOccupied&&(y-=rowHeight+5,rowHeight=rowColumns=columnsOccupied=0,++row))},alignItemsInRows:function(rows){var i,columns=[];for(i=1;i<arguments.length;i++)columns.push(arguments[i]);var columnRows,tmp,columnWidths=[],columnHeights=[],width=-10,columnHeight=-5,column=0,columnWidth=0,rowsOccupied=0;if(this._children&&0<this._children.length)for(i=0;i<this._children.length;i++)if(this._children[i]){if(column>=columns.length){cc.log("cc.MenuPassive.alignItemsInRows(): invalid row index");continue}if(!(columnRows=columns[column])){cc.log("cc.MenuPassive.alignItemsInColumns(): can't have zero rows on a column");continue}columnWidth=0|((tmp=this._children[i].getContentSize().width)<=columnWidth||null==tmp?columnWidth:tmp),columnHeight+=0|this._children[i].getContentSize().height+5,columnRows<=++rowsOccupied&&(columnWidths.push(columnWidth),columnHeights.push(columnHeight),width+=columnWidth+10,columnWidth=rowsOccupied=0,columnHeight=-5,++column)}var winSize=cc.director.getWinSize();columnRows=null;var x=-width/2,y=columnWidth=column=0;if(this._children&&0<this._children.length)for(i=0;i<this._children.length;i++)this._children[i]&&(null==columnRows&&(columnRows=columns[column],y=columnHeights[column]),columnWidth=0|((tmp=this._children[i].getContentSize().width)<=columnWidth||null==tmp?columnWidth:tmp),this._children[i].setPosition(x+columnWidths[column]/2,y-winSize.height/2),y-=this._children[i].getContentSize().height+10,columnRows<=++rowsOccupied&&(x+=columnWidth+5,columnWidth=columnRows=rowsOccupied=0,++column))},setOpacityModifyRGB:function(bValue){},isOpacityModifyRGB:function(){return!1}}),cc.MenuPassive.create=function(item){item||(item=null);for(var argArr=[],i=1;i<arguments.length;i++)argArr.push(arguments[i]);var pRet=new cc.MenuPassive;return pRet&&pRet.initWithItems(item,argArr)?pRet:null},cc.MenuPassive.createWithItem=function(item){return cc.MenuPassive.create(item,null)},cc.ControlSaturationBrightnessPicker=cc.Control.extend({_saturation:0,_brightness:0,_background:null,_overlay:null,_shadow:null,_slider:null,_startPos:null,_boxPos:0,_boxSize:0,_className:"ControlSaturationBrightnessPicker",ctor:function(target,pos){cc.Control.prototype.ctor.call(this),pos&&this.initWithTargetAndPos(target,pos)},getSaturation:function(){return this._saturation},getBrightness:function(){return this._brightness},getBackground:function(){return this._background},getOverlay:function(){return this._brightness},getShadow:function(){return this._shadow},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(target,pos){return!!cc.Control.prototype.init.call(this)&&(this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerBackground.png",target,pos,cc.p(0,0)),this._overlay=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerOverlay.png",target,pos,cc.p(0,0)),this._shadow=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerShadow.png",target,pos,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",target,pos,cc.p(.5,.5)),this._startPos=pos,this._boxPos=35,this._boxSize=this._background.getContentSize().width/2,!0)},setEnabled:function(enabled){cc.Control.prototype.setEnabled.call(this,enabled),this._slider&&this._slider.setOpacity(enabled?255:128)},updateWithHSV:function(hsv){var hsvTemp=new cc.HSV;hsvTemp.s=1,hsvTemp.h=hsv.h,hsvTemp.v=1;var rgb=cc.ControlUtils.RGBfromHSV(hsvTemp);this._background.setColor(cc.color(0|255*rgb.r,0|255*rgb.g,0|255*rgb.b))},updateDraggerWithHSV:function(hsv){var pos=cc.p(this._startPos.x+this._boxPos+this._boxSize*(1-hsv.s),this._startPos.y+this._boxPos+this._boxSize*hsv.v);this._updateSliderPosition(pos)},_updateSliderPosition:function(sliderPosition){var centerX=this._startPos.x+.5*this._background.getBoundingBox().width,centerY=this._startPos.y+.5*this._background.getBoundingBox().height,dx=sliderPosition.x-centerX,dy=sliderPosition.y-centerY,dist=Math.sqrt(dx*dx+dy*dy),angle=Math.atan2(dy,dx),limit=.5*this._background.getBoundingBox().width;limit<dist&&(sliderPosition.x=centerX+limit*Math.cos(angle),sliderPosition.y=centerY+limit*Math.sin(angle)),this._slider.setPosition(sliderPosition),sliderPosition.x<this._startPos.x+this._boxPos?sliderPosition.x=this._startPos.x+this._boxPos:sliderPosition.x>this._startPos.x+this._boxPos+this._boxSize-1&&(sliderPosition.x=this._startPos.x+this._boxPos+this._boxSize-1),sliderPosition.y<this._startPos.y+this._boxPos?sliderPosition.y=this._startPos.y+this._boxPos:sliderPosition.y>this._startPos.y+this._boxPos+this._boxSize&&(sliderPosition.y=this._startPos.y+this._boxPos+this._boxSize),this._saturation=1-Math.abs((this._startPos.x+this._boxPos-sliderPosition.x)/this._boxSize),this._brightness=Math.abs((this._startPos.y+this._boxPos-sliderPosition.y)/this._boxSize)},_checkSliderPosition:function(location){var centerX=this._startPos.x+.5*this._background.getBoundingBox().width,centerY=this._startPos.y+.5*this._background.getBoundingBox().height,dx=location.x-centerX,dy=location.y-centerY;return Math.sqrt(dx*dx+dy*dy)<=.5*this._background.getBoundingBox().width&&(this._updateSliderPosition(location),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),!0)},onTouchBegan:function(touch,event){if(!this.isEnabled()||!this.isVisible())return!1;var touchLocation=this.getTouchLocation(touch);return this._checkSliderPosition(touchLocation)},onTouchMoved:function(touch,event){var touchLocation=this.getTouchLocation(touch);this._checkSliderPosition(touchLocation)}}),(_p=cc.ControlSaturationBrightnessPicker.prototype).saturation,cc.defineGetterSetter(_p,"saturation",_p.getSaturation),_p.brightness,cc.defineGetterSetter(_p,"brightness",_p.getBrightness),_p.background,cc.defineGetterSetter(_p,"background",_p.getBackground),_p.overlay,cc.defineGetterSetter(_p,"overlay",_p.getOverlay),_p.shadow,cc.defineGetterSetter(_p,"shadow",_p.getShadow),_p.slider,cc.defineGetterSetter(_p,"slider",_p.getSlider),_p.startPos,cc.defineGetterSetter(_p,"startPos",_p.getStartPos),_p=null,cc.ControlSaturationBrightnessPicker.create=function(target,pos){return new cc.ControlSaturationBrightnessPicker(target,pos)},cc.ControlHuePicker=cc.Control.extend({_hue:0,_huePercentage:0,_background:null,_slider:null,_startPos:null,_className:"ControlHuePicker",ctor:function(target,pos){cc.Control.prototype.ctor.call(this),pos&&this.initWithTargetAndPos(target,pos)},getHue:function(){return this._hue},setHue:function(hueValue){this._hue=hueValue,this.setHuePercentage(this._hue/360)},getHuePercentage:function(){return this._huePercentage},setHuePercentage:function(hueValueInPercent){this._huePercentage=hueValueInPercent,this._hue=360*this._huePercentage;var backgroundBox=this._background.getBoundingBox(),centerX=this._startPos.x+.5*backgroundBox.width,centerY=this._startPos.y+.5*backgroundBox.height,limit=.5*backgroundBox.width-15,angleDeg=360*this._huePercentage-180,angle=cc.degreesToRadians(angleDeg),x=centerX+limit*Math.cos(angle),y=centerY+limit*Math.sin(angle);this._slider.setPosition(x,y)},setEnabled:function(enabled){cc.Control.prototype.setEnabled.call(this,enabled),this._slider&&this._slider.setOpacity(enabled?255:128)},getBackground:function(){return this._background},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(target,pos){return!!cc.Control.prototype.init.call(this)&&(this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("huePickerBackground.png",target,pos,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",target,pos,cc.p(.5,.5)),this._slider.setPosition(pos.x,pos.y+.5*this._background.getBoundingBox().height),this._startPos=pos,this._hue=0,!(this._huePercentage=0))},_updateSliderPosition:function(location){var backgroundBox=this._background.getBoundingBox(),centerX=this._startPos.x+.5*backgroundBox.width,centerY=this._startPos.y+.5*backgroundBox.height,dx=location.x-centerX,dy=location.y-centerY,angle=Math.atan2(dy,dx),angleDeg=cc.radiansToDegrees(angle)+180;this.setHue(angleDeg),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},_checkSliderPosition:function(location){var distance=Math.sqrt(Math.pow(location.x+10,2)+Math.pow(location.y,2));return distance<80&&59<distance&&(this._updateSliderPosition(location),!0)},onTouchBegan:function(touch,event){if(!this.isEnabled()||!this.isVisible())return!1;var touchLocation=this.getTouchLocation(touch);return this._checkSliderPosition(touchLocation)},onTouchMoved:function(touch,event){var touchLocation=this.getTouchLocation(touch);this._checkSliderPosition(touchLocation)}}),(_p=cc.ControlHuePicker.prototype).hue,cc.defineGetterSetter(_p,"hue",_p.getHue,_p.setHue),_p.huePercent,cc.defineGetterSetter(_p,"huePercent",_p.getHuePercentage,_p.setHuePercentage),_p.background,cc.defineGetterSetter(_p,"background",_p.getBackground),_p.slider,cc.defineGetterSetter(_p,"slider",_p.getSlider),_p.startPos,cc.defineGetterSetter(_p,"startPos",_p.getStartPos),_p=null,cc.ControlHuePicker.create=function(target,pos){return new cc.ControlHuePicker(target,pos)},cc.ControlColourPicker=cc.Control.extend({_hsv:null,_colourPicker:null,_huePicker:null,_background:null,_className:"ControlColourPicker",ctor:function(){cc.Control.prototype.ctor.call(this),this.init()},hueSliderValueChanged:function(sender,controlEvent){this._hsv.h=sender.getHue();var rgb=cc.ControlUtils.RGBfromHSV(this._hsv);cc.Control.prototype.setColor.call(this,cc.color(0|255*rgb.r,0|255*rgb.g,0|255*rgb.b)),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),this._updateControlPicker()},colourSliderValueChanged:function(sender,controlEvent){this._hsv.s=sender.getSaturation(),this._hsv.v=sender.getBrightness();var rgb=cc.ControlUtils.RGBfromHSV(this._hsv);cc.Control.prototype.setColor.call(this,cc.color(0|255*rgb.r,0|255*rgb.g,0|255*rgb.b)),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},setColor:function(color){cc.Control.prototype.setColor.call(this,color);var rgba=new cc.RGBA;rgba.r=color.r/255,rgba.g=color.g/255,rgba.b=color.b/255,rgba.a=1,this._hsv=cc.ControlUtils.HSVfromRGB(rgba),this._updateHueAndControlPicker()},getBackground:function(){return this._background},init:function(){if(cc.Control.prototype.init.call(this)){cc.spriteFrameCache.addSpriteFrames(res.CCControlColourPickerSpriteSheet_plist);var spriteSheet=new cc.SpriteBatchNode(res.CCControlColourPickerSpriteSheet_png);this.addChild(spriteSheet),this._hsv=new cc.HSV(0,0,0),this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("menuColourPanelBackground.png",spriteSheet,cc.p(0,0),cc.p(.5,.5));var backgroundPointZero=cc.pSub(this._background.getPosition(),cc.p(this._background.getContentSize().width/2,this._background.getContentSize().height/2));return this._huePicker=new cc.ControlHuePicker(spriteSheet,cc.p(backgroundPointZero.x+8,backgroundPointZero.y+8)),this._colourPicker=new cc.ControlSaturationBrightnessPicker(spriteSheet,cc.p(backgroundPointZero.x+28,backgroundPointZero.y+28)),this._huePicker.addTargetWithActionForControlEvents(this,this.hueSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._colourPicker.addTargetWithActionForControlEvents(this,this.colourSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._updateHueAndControlPicker(),this.addChild(this._huePicker),this.addChild(this._colourPicker),this.setContentSize(this._background.getContentSize()),!0}return!1},_updateControlPicker:function(){this._huePicker.setHue(this._hsv.h),this._colourPicker.updateWithHSV(this._hsv)},_updateHueAndControlPicker:function(){this._huePicker.setHue(this._hsv.h),this._colourPicker.updateWithHSV(this._hsv),this._colourPicker.updateDraggerWithHSV(this._hsv)},setEnabled:function(enabled){cc.Control.prototype.setEnabled.call(this,enabled),null!==this._huePicker&&this._huePicker.setEnabled(enabled),this._colourPicker&&this._colourPicker.setEnabled(enabled)},onTouchBegan:function(){return!1}}),(_p=cc.ControlColourPicker.prototype).background,cc.defineGetterSetter(_p,"background",_p.getBackground),_p=null,cc.ControlColourPicker.create=function(){return new cc.ControlColourPicker};var res=res||{};res.CCControlColourPickerSpriteSheet_plist=res.CCControlColourPickerSpriteSheet_plist||"res/extensions/CCControlColourPickerSpriteSheet.plist",res.CCControlColourPickerSpriteSheet_png=res.CCControlColourPickerSpriteSheet_png||"res/extensions/CCControlColourPickerSpriteSheet.png",cc.SLIDER_MARGIN_H=24,cc.SLIDER_MARGIN_V=8,cc.ControlSlider=cc.Control.extend({_value:0,_minimumValue:0,_maximumValue:0,_minimumAllowedValue:0,_maximumAllowedValue:0,_thumbSprite:null,_progressSprite:null,_backgroundSprite:null,_className:"ControlSlider",ctor:function(bgFile,progressFile,thumbFile){if(cc.Control.prototype.ctor.call(this),null!=thumbFile){var bgSprite=new cc.Sprite(bgFile),progressSprite=new cc.Sprite(progressFile),thumbSprite=new cc.Sprite(thumbFile);this.initWithSprites(bgSprite,progressSprite,thumbSprite)}},getValue:function(){return this._value},setValue:function(value){value=Math.max(value,this._minimumValue),value=Math.min(value,this._maximumValue),this._value=value,this.needsLayout(),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getMinimumValue:function(){return this._minimumValue},setMinimumValue:function(minimumValue){this._minimumValue=minimumValue,this._minimumAllowedValue=minimumValue,this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1),this.setValue(this._value)},getMaximumValue:function(){return this._maximumValue},setMaximumValue:function(maximumValue){this._maximumValue=maximumValue,this._maximumAllowedValue=maximumValue,this._maximumValue<=this._minimumValue&&(this._minimumValue=this._maximumValue-1),this.setValue(this._value)},isTouchInside:function(touch){var touchLocation=touch.getLocation();touchLocation=this.getParent().convertToNodeSpace(touchLocation);var rect=this.getBoundingBox();return rect.width+=this._thumbSprite.getContentSize().width,rect.x-=this._thumbSprite.getContentSize().width/2,cc.rectContainsPoint(rect,touchLocation)},locationFromTouch:function(touch){var touchLocation=touch.getLocation();return(touchLocation=this.convertToNodeSpace(touchLocation)).x<0?touchLocation.x=0:touchLocation.x>this._backgroundSprite.getContentSize().width&&(touchLocation.x=this._backgroundSprite.getContentSize().width),touchLocation},getMinimumAllowedValue:function(){return this._minimumAllowedValue},setMinimumAllowedValue:function(val){this._minimumAllowedValue=val},getMaximumAllowedValue:function(){return this._maximumAllowedValue},setMaximumAllowedValue:function(val){this._maximumAllowedValue=val},getThumbSprite:function(){return this._thumbSprite},getProgressSprite:function(){return this._progressSprite},getBackgroundSprite:function(){return this._backgroundSprite},initWithSprites:function(backgroundSprite,progressSprite,thumbSprite){if(cc.Control.prototype.init.call(this)){this.ignoreAnchorPointForPosition(!1),this._backgroundSprite=backgroundSprite,this._progressSprite=progressSprite,this._thumbSprite=thumbSprite;var maxRect=cc.ControlUtils.CCRectUnion(backgroundSprite.getBoundingBox(),thumbSprite.getBoundingBox());return this.setContentSize(maxRect.width,maxRect.height),this._backgroundSprite.setAnchorPoint(.5,.5),this._backgroundSprite.setPosition(maxRect.width/2,maxRect.height/2),this.addChild(this._backgroundSprite),this._progressSprite.setAnchorPoint(0,.5),this._progressSprite.setPosition(0,maxRect.height/2),this.addChild(this._progressSprite),this._thumbSprite.setPosition(0,maxRect.height/2),this.addChild(this._thumbSprite),this._minimumValue=0,this._maximumValue=1,this.setValue(this._minimumValue),!0}return!1},setEnabled:function(enabled){cc.Control.prototype.setEnabled.call(this,enabled),this._thumbSprite&&this._thumbSprite.setOpacity(enabled?255:128)},sliderBegan:function(location){this.setSelected(!0),this._thumbSprite.setColor(cc.color.GRAY),this.setValue(this.valueForLocation(location))},sliderMoved:function(location){this.setValue(this.valueForLocation(location))},sliderEnded:function(location){this.isSelected()&&this.setValue(this.valueForLocation(this._thumbSprite.getPosition())),this._thumbSprite.setColor(cc.color.WHITE),this.setSelected(!1)},getTouchLocationInControl:function(touch){var touchLocation=touch.getLocation();return(touchLocation=this.convertToNodeSpace(touchLocation)).x<0?touchLocation.x=0:touchLocation.x>this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H&&(touchLocation.x=this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H),touchLocation},onTouchBegan:function(touch,event){if(!this.isTouchInside(touch)||!this.isEnabled()||!this.isVisible())return!1;var location=this.locationFromTouch(touch);return this.sliderBegan(location),!0},onTouchMoved:function(touch,event){var location=this.locationFromTouch(touch);this.sliderMoved(location)},onTouchEnded:function(touch,event){this.sliderEnded(cc.p(0,0))},needsLayout:function(){var percent=(this._value-this._minimumValue)/(this._maximumValue-this._minimumValue);this._thumbSprite.setPositionX(percent*this._backgroundSprite.getContentSize().width);var textureRect=this._progressSprite.getTextureRect();textureRect=cc.rect(textureRect.x,textureRect.y,this._thumbSprite.getPositionX(),textureRect.height),this._progressSprite.setTextureRect(textureRect,this._progressSprite.isTextureRectRotated()),this._thumbSprite._renderCmd.transform(this._renderCmd)},valueForLocation:function(location){var percent=location.x/this._backgroundSprite.getContentSize().width;return Math.max(Math.min(this._minimumValue+percent*(this._maximumValue-this._minimumValue),this._maximumAllowedValue),this._minimumAllowedValue)}}),(_p=cc.ControlSlider.prototype).value,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),_p.minValue,cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),_p.maxValue,cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),_p.minAllowedValue,cc.defineGetterSetter(_p,"minAllowedValue",_p.getMinimumAllowedValue,_p.setMinimumAllowedValue),_p.maxAllowedValue,cc.defineGetterSetter(_p,"maxAllowedValue",_p.getMaximumAllowedValue,_p.setMaximumAllowedValue),_p.thumbSprite,cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite),_p.progressSprite,cc.defineGetterSetter(_p,"progressSprite",_p.getProgressSprite),_p.backgroundSprite,cc.defineGetterSetter(_p,"backgroundSprite",_p.getBackgroundSprite),_p=null,cc.ControlSlider.create=function(bgFile,progressFile,thumbFile){return new cc.ControlSlider(bgFile,progressFile,thumbFile)},cc.ControlSwitch=cc.Control.extend({_switchSprite:null,_initialTouchXPosition:0,_moved:!1,_on:!1,_className:"ControlSwitch",ctor:function(maskSprite,onSprite,offSprite,thumbSprite,onLabel,offLabel){cc.Control.prototype.ctor.call(this),offLabel&&this.initWithMaskSprite(maskSprite,onSprite,offSprite,thumbSprite,onLabel,offLabel)},initWithMaskSprite:function(maskSprite,onSprite,offSprite,thumbSprite,onLabel,offLabel){if(!maskSprite)throw new Error("cc.ControlSwitch.initWithMaskSprite(): maskSprite should be non-null.");if(!onSprite)throw new Error("cc.ControlSwitch.initWithMaskSprite(): onSprite should be non-null.");if(!offSprite)throw new Error("cc.ControlSwitch.initWithMaskSprite(): offSprite should be non-null.");if(!thumbSprite)throw new Error("cc.ControlSwitch.initWithMaskSprite(): thumbSprite should be non-null.");return!!this.init()&&(this._on=!0,this._switchSprite=new cc.ControlSwitchSprite,this._switchSprite.initWithMaskSprite(maskSprite,onSprite,offSprite,thumbSprite,onLabel,offLabel),this._switchSprite.setPosition(this._switchSprite.getContentSize().width/2,this._switchSprite.getContentSize().height/2),this.addChild(this._switchSprite),this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(.5,.5),this.setContentSize(this._switchSprite.getContentSize()),!0)},setOn:function(isOn,animated){animated=animated||!1,this._on=isOn;var xPosition=this._on?this._switchSprite.getOnPosition():this._switchSprite.getOffPosition();animated?this._switchSprite.runAction(new cc.ActionTween(.2,"sliderXPosition",this._switchSprite.getSliderXPosition(),xPosition)):this._switchSprite.setSliderXPosition(xPosition),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},isOn:function(){return this._on},hasMoved:function(){return this._moved},setEnabled:function(enabled){this._enabled=enabled,this._switchSprite.setOpacity(enabled?255:128)},locationFromTouch:function(touch){var touchLocation=touch.getLocation();return touchLocation=this.convertToNodeSpace(touchLocation)},onTouchBegan:function(touch,event){if(!this.isTouchInside(touch)||!this.isEnabled()||!this.isVisible())return!1;this._moved=!1;var location=this.locationFromTouch(touch);return this._initialTouchXPosition=location.x-this._switchSprite.getSliderXPosition(),this._switchSprite.getThumbSprite().setColor(cc.color.GRAY),this._switchSprite.needsLayout(),!0},onTouchMoved:function(touch,event){var location=this.locationFromTouch(touch);location=cc.p(location.x-this._initialTouchXPosition,0),this._moved=!0,this._switchSprite.setSliderXPosition(location.x)},onTouchEnded:function(touch,event){var location=this.locationFromTouch(touch);this._switchSprite.getThumbSprite().setColor(cc.color.WHITE),this.hasMoved()?this.setOn(!(location.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)},onTouchCancelled:function(touch,event){var location=this.locationFromTouch(touch);this._switchSprite.getThumbSprite().setColor(cc.color.WHITE),this.hasMoved()?this.setOn(!(location.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)}}),cc.ControlSwitch.create=function(maskSprite,onSprite,offSprite,thumbSprite,onLabel,offLabel){return new cc.ControlSwitch(maskSprite,onSprite,offSprite,thumbSprite,onLabel,offLabel)},cc.ControlSwitchSprite=cc.Sprite.extend({_sliderXPosition:0,_onPosition:0,_offPosition:0,_textureLocation:0,_maskLocation:0,_maskSize:null,_onSprite:null,_offSprite:null,_thumbSprite:null,_onLabel:null,_offLabel:null,_clipper:null,_stencil:null,_backRT:null,ctor:function(){cc.Sprite.prototype.ctor.call(this),this._sliderXPosition=0,this._onPosition=0,this._offPosition=0,this._maskLocation=0,this._maskSize=cc.size(0,0),this._onSprite=null,this._offSprite=null,this._thumbSprite=null,this._onLabel=null,this._offLabel=null},initWithMaskSprite:function(maskSprite,onSprite,offSprite,thumbSprite,onLabel,offLabel){if(cc.Sprite.prototype.init.call(this)){this.setSpriteFrame(maskSprite.displayFrame()),this._onPosition=0,this._offPosition=-onSprite.getContentSize().width+thumbSprite.getContentSize().width/2,this._sliderXPosition=this._onPosition,this.setOnSprite(onSprite),this.setOffSprite(offSprite),this.setThumbSprite(thumbSprite),this.setOnLabel(onLabel),this.setOffLabel(offLabel),this._stencil=maskSprite;var maskSize=this._maskSize=this._stencil.getContentSize();return this._stencil.setPosition(0,0),this._clipper=new cc.ClippingNode,this._clipper.setAnchorPoint(.5,.5),this._clipper.setPosition(maskSize.width/2,maskSize.height/2),this._clipper.setStencil(this._stencil),this.addChild(this._clipper),this._clipper.addChild(onSprite),this._clipper.addChild(offSprite),this._clipper.addChild(onLabel),this._clipper.addChild(offLabel),this.addChild(this._thumbSprite),this.needsLayout(),!0}return!1},needsLayout:function(){var maskSize=this._maskSize;this._onSprite.setPosition(this._onSprite.getContentSize().width/2+this._sliderXPosition-maskSize.width/2,this._onSprite.getContentSize().height/2-maskSize.height/2),this._offSprite.setPosition(this._onSprite.getContentSize().width+this._offSprite.getContentSize().width/2+this._sliderXPosition-maskSize.width/2,this._offSprite.getContentSize().height/2-maskSize.height/2),this._onLabel&&this._onLabel.setPosition(this._onSprite.getPositionX()-this._thumbSprite.getContentSize().width/6,this._onSprite.getContentSize().height/2-maskSize.height/2),this._offLabel&&this._offLabel.setPosition(this._offSprite.getPositionX()+this._thumbSprite.getContentSize().width/6,this._offSprite.getContentSize().height/2-maskSize.height/2),this._thumbSprite.setPosition(this._onSprite.getContentSize().width+this._sliderXPosition,this._maskSize.height/2)},setSliderXPosition:function(sliderXPosition){sliderXPosition<=this._offPosition?sliderXPosition=this._offPosition:sliderXPosition>=this._onPosition&&(sliderXPosition=this._onPosition),this._sliderXPosition=sliderXPosition,this.needsLayout()},getSliderXPosition:function(){return this._sliderXPosition},_getOnSideWidth:function(){return this._onSprite.getContentSize().width},_getOffSideWidth:function(){return this._offSprite.getContentSize().height},updateTweenAction:function(value,key){"sliderXPosition"===key&&this.setSliderXPosition(value)},setOnPosition:function(onPosition){this._onPosition=onPosition},getOnPosition:function(){return this._onPosition},setOffPosition:function(offPosition){this._offPosition=offPosition},getOffPosition:function(){return this._offPosition},setMaskTexture:function(maskTexture){this._stencil.setTexture(maskTexture)},getMaskTexture:function(){return this._stencil.getTexture()},setTextureLocation:function(textureLocation){this._textureLocation=textureLocation},getTextureLocation:function(){return this._textureLocation},setMaskLocation:function(maskLocation){this._maskLocation=maskLocation},getMaskLocation:function(){return this._maskLocation},setOnSprite:function(onSprite){this._onSprite=onSprite},getOnSprite:function(){return this._onSprite},setOffSprite:function(offSprite){this._offSprite=offSprite},getOffSprite:function(){return this._offSprite},setThumbSprite:function(thumbSprite){this._thumbSprite=thumbSprite},getThumbSprite:function(){return this._thumbSprite},setOnLabel:function(onLabel){this._onLabel=onLabel},getOnLabel:function(){return this._onLabel},setOffLabel:function(offLabel){this._offLabel=offLabel},getOffLabel:function(){return this._offLabel}}),(_p=cc.ControlSwitchSprite.prototype).sliderX,cc.defineGetterSetter(_p,"sliderX",_p.getSliderXPosition,_p.setSliderXPosition),_p.onPos,cc.defineGetterSetter(_p,"onPos",_p.getOnPosition,_p.setOnPosition),_p.offPos,cc.defineGetterSetter(_p,"offPos",_p.getOffPosition,_p.setOffPosition),_p.maskTexture,cc.defineGetterSetter(_p,"maskTexture",_p.getMaskTexture,_p.setMaskTexture),_p.maskPos,cc.defineGetterSetter(_p,"maskPos",_p.getMaskLocation,_p.setMaskLocation),_p.onSprite,cc.defineGetterSetter(_p,"onSprite",_p.getOnSprite,_p.setOnSprite),_p.offSprite,cc.defineGetterSetter(_p,"offSprite",_p.getOffSprite,_p.setOffSprite),_p.thumbSprite,cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite,_p.setThumbSprite),_p.onLabel,cc.defineGetterSetter(_p,"onLabel",_p.getOnLabel,_p.setOnLabel),_p.offLabel,cc.defineGetterSetter(_p,"offLabel",_p.getOffLabel,_p.setOffLabel),_p.onSideWidth,cc.defineGetterSetter(_p,"onSideWidth",_p._getOnSideWidth),_p.offSideWidth,cc.defineGetterSetter(_p,"offSideWidth",_p._getOffSideWidth),_p=null,cc.CONTROL_STEPPER_PARTMINUS=0,cc.CONTROL_STEPPER_PARTPLUS=1,cc.CONTROL_STEPPER_PARTNONE=2,cc.CONTROL_STEPPER_LABELCOLOR_ENABLED=cc.color(55,55,55),cc.CONTROL_STEPPER_LABELCOLOR_DISABLED=cc.color(147,147,147),cc.CONTROL_STEPPER_LABELFONT="CourierNewPSMT",cc.AUTOREPEAT_DELTATIME=.15,cc.AUTOREPEAT_INCREASETIME_INCREMENT=12,cc.ControlStepper=cc.Control.extend({_minusSprite:null,_plusSprite:null,_minusLabel:null,_plusLabel:null,_value:0,_continuous:!1,_autorepeat:!1,_wraps:!1,_minimumValue:0,_maximumValue:0,_stepValue:0,_touchInsideFlag:!1,_touchedPart:cc.CONTROL_STEPPER_PARTNONE,_autorepeatCount:0,_className:"ControlStepper",ctor:function(minusSprite,plusSprite){cc.Control.prototype.ctor.call(this),this._minusSprite=null,this._plusSprite=null,this._minusLabel=null,this._plusLabel=null,this._value=0,this._continuous=!1,this._autorepeat=!1,this._wraps=!1,this._minimumValue=0,this._maximumValue=0,this._stepValue=0,this._touchInsideFlag=!1,this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._autorepeatCount=0,plusSprite&&this.initWithMinusSpriteAndPlusSprite(minusSprite,plusSprite)},initWithMinusSpriteAndPlusSprite:function(minusSprite,plusSprite){if(!minusSprite)throw new Error("cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Minus sprite should be non-null.");if(!plusSprite)throw new Error("cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Plus sprite should be non-null.");if(this.init()){this._autorepeat=!0,this._continuous=!0,this._minimumValue=0,this._maximumValue=100,this._value=0,this._stepValue=1,this._wraps=!1,this.ignoreAnchorPointForPosition(!1),this.setMinusSprite(minusSprite),this._minusSprite.setPosition(minusSprite.getContentSize().width/2,minusSprite.getContentSize().height/2),this.addChild(this._minusSprite),this.setMinusLabel(new cc.LabelTTF("-",cc.CONTROL_STEPPER_LABELFONT,40,cc.size(40,40),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER)),this._minusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_DISABLED),this._minusLabel.setPosition(this._minusSprite.getContentSize().width/2,this._minusSprite.getContentSize().height/2),this._minusSprite.addChild(this._minusLabel),this.setPlusSprite(plusSprite),this._plusSprite.setPosition(minusSprite.getContentSize().width+plusSprite.getContentSize().width/2,minusSprite.getContentSize().height/2),this.addChild(this._plusSprite),this.setPlusLabel(new cc.LabelTTF("+",cc.CONTROL_STEPPER_LABELFONT,40,cc.size(40,40),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER)),this._plusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setPosition(this._plusSprite.getContentSize().width/2,this._plusSprite.getContentSize().height/2),this._plusSprite.addChild(this._plusLabel);var maxRect=cc.ControlUtils.CCRectUnion(this._minusSprite.getBoundingBox(),this._plusSprite.getBoundingBox());return this.setContentSize(this._minusSprite.getContentSize().width+this._plusSprite.getContentSize().height,maxRect.height),!0}return!1},setWraps:function(wraps){this._wraps=wraps,this._wraps&&(this._minusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED)),this.setValue(this._value)},getWraps:function(){return this._wraps},setMinimumValue:function(minimumValue){if(minimumValue>=this._maximumValue)throw new Error("cc.ControlStepper.setMinimumValue(): minimumValue should be numerically less than maximumValue.");this._minimumValue=minimumValue,this.setValue(this._value)},getMinimumValue:function(){return this._minimumValue},setMaximumValue:function(maximumValue){if(maximumValue<=this._minimumValue)throw new Error("cc.ControlStepper.setMaximumValue(): maximumValue should be numerically less than maximumValue.");this._maximumValue=maximumValue,this.setValue(this._value)},getMaximumValue:function(){return this._maximumValue},setValue:function(value){this.setValueWithSendingEvent(value,!0)},getValue:function(){return this._value},setStepValue:function(stepValue){if(stepValue<=0)throw new Error("cc.ControlStepper.setMaximumValue(): stepValue should be numerically greater than 0.");this._stepValue=stepValue},getStepValue:function(){return this._stepValue},isContinuous:function(){return this._continuous},setValueWithSendingEvent:function(value,send){value<this._minimumValue?value=this._wraps?this._maximumValue:this._minimumValue:value>this._maximumValue&&(value=this._wraps?this._minimumValue:this._maximumValue),this._value=value,this._wraps||(this._minusLabel.setColor(value===this._minimumValue?cc.CONTROL_STEPPER_LABELCOLOR_DISABLED:cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setColor(value===this._maximumValue?cc.CONTROL_STEPPER_LABELCOLOR_DISABLED:cc.CONTROL_STEPPER_LABELCOLOR_ENABLED)),send&&this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},startAutorepeat:function(){this._autorepeatCount=-1,this.schedule(this.update,cc.AUTOREPEAT_DELTATIME,cc.REPEAT_FOREVER,3*cc.AUTOREPEAT_DELTATIME)},stopAutorepeat:function(){this.unschedule(this.update)},update:function(dt){this._autorepeatCount++,this._autorepeatCount<cc.AUTOREPEAT_INCREASETIME_INCREMENT&&this._autorepeatCount%3!=0||(this._touchedPart===cc.CONTROL_STEPPER_PARTMINUS?this.setValueWithSendingEvent(this._value-this._stepValue,this._continuous):this._touchedPart===cc.CONTROL_STEPPER_PARTPLUS&&this.setValueWithSendingEvent(this._value+this._stepValue,this._continuous))},updateLayoutUsingTouchLocation:function(location){location.x<this._minusSprite.getContentSize().width&&this._value>this._minimumValue?(this._touchedPart=cc.CONTROL_STEPPER_PARTMINUS,this._minusSprite.setColor(cc.color.GRAY),this._plusSprite.setColor(cc.color.WHITE)):location.x>=this._minusSprite.getContentSize().width&&this._value<this._maximumValue?(this._touchedPart=cc.CONTROL_STEPPER_PARTPLUS,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.GRAY)):(this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE))},onTouchBegan:function(touch,event){if(!this.isTouchInside(touch)||!this.isEnabled()||!this.isVisible())return!1;var location=this.getTouchLocation(touch);return this.updateLayoutUsingTouchLocation(location),this._touchInsideFlag=!0,this._autorepeat&&this.startAutorepeat(),!0},onTouchMoved:function(touch,event){if(this.isTouchInside(touch)){var location=this.getTouchLocation(touch);this.updateLayoutUsingTouchLocation(location),this._touchInsideFlag||(this._touchInsideFlag=!0,this._autorepeat&&this.startAutorepeat())}else this._touchInsideFlag=!1,this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE),this._autorepeat&&this.stopAutorepeat()},onTouchEnded:function(touch,event){if(this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE),this._autorepeat&&this.stopAutorepeat(),this.isTouchInside(touch)){var location=this.getTouchLocation(touch);this.setValue(this._value+(location.x<this._minusSprite.getContentSize().width?0-this._stepValue:this._stepValue))}},setMinusSprite:function(sprite){this._minusSprite=sprite},getMinusSprite:function(){return this._minusSprite},setPlusSprite:function(sprite){this._plusSprite=sprite},getPlusSprite:function(){return this._plusSprite},setMinusLabel:function(sprite){this._minusLabel=sprite},getMinusLabel:function(){return this._minusLabel},setPlusLabel:function(sprite){this._plusLabel=sprite},getPlusLabel:function(){return this._plusLabel}}),(_p=cc.ControlStepper.prototype).wraps,cc.defineGetterSetter(_p,"wraps",_p.getWraps,_p.setWraps),_p.value,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),_p.minValue,cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),_p.maxValue,cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),_p.stepValue,cc.defineGetterSetter(_p,"stepValue",_p.getStepValue,_p.setStepValue),_p.continuous,cc.defineGetterSetter(_p,"continuous",_p.isContinuous),_p.minusSprite,cc.defineGetterSetter(_p,"minusSprite",_p.getMinusSprite,_p.setMinusSprite),_p.plusSprite,cc.defineGetterSetter(_p,"plusSprite",_p.getPlusSprite,_p.setPlusSprite),_p.minusLabel,cc.defineGetterSetter(_p,"minusLabel",_p.getMinusLabel,_p.setMinusLabel),_p.plusLabel,cc.defineGetterSetter(_p,"plusLabel",_p.getPlusLabel,_p.setPlusLabel),_p=null,cc.ControlStepper.create=function(minusSprite,plusSprite){return new cc.ControlStepper(minusSprite,plusSprite)},cc.ControlPotentiometer=cc.Control.extend({_thumbSprite:null,_progressTimer:null,_previousLocation:null,_value:0,_minimumValue:0,_maximumValue:1,_className:"ControlPotentiometer",ctor:function(backgroundFile,progressFile,thumbFile){if(cc.Control.prototype.ctor.call(this),null!=thumbFile){var backgroundSprite=new cc.Sprite(backgroundFile),thumbSprite=new cc.Sprite(thumbFile),progressTimer=new cc.ProgressTimer(new cc.Sprite(progressFile));this.initWithTrackSprite_ProgressTimer_ThumbSprite(backgroundSprite,progressTimer,thumbSprite)}},initWithTrackSprite_ProgressTimer_ThumbSprite:function(trackSprite,progressTimer,thumbSprite){return!!this.init()&&(this.setProgressTimer(progressTimer),this.setThumbSprite(thumbSprite),this._thumbSprite.setPosition(progressTimer.getPosition()),this.addChild(thumbSprite,2),this.addChild(progressTimer,1),this.addChild(trackSprite),this.setContentSize(trackSprite.getContentSize()),this._minimumValue=0,this._maximumValue=1,this.setValue(this._minimumValue),!0)},setEnabled:function(enabled){this.setEnabled(enabled),null!==this._thumbSprite&&this._thumbSprite.setOpacity(enabled?255:128)},setValue:function(value){value<this._minimumValue&&(value=this._minimumValue),value>this._maximumValue&&(value=this._maximumValue);var percent=((this._value=value)-this._minimumValue)/(this._maximumValue-this._minimumValue);this._progressTimer.setPercentage(100*percent),this._thumbSprite.setRotation(360*percent),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getValue:function(){return this._value},setMinimumValue:function(minimumValue){this._minimumValue=minimumValue,this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1),this.setValue(this._maximumValue)},getMinimumValue:function(){return this._minimumValue},setMaximumValue:function(maximumValue){this._maximumValue=maximumValue,this._maximumValue<=this._minimumValue&&(this._minimumValue=this._maximumValue-1),this.setValue(this._minimumValue)},getMaximumValue:function(){return this._maximumValue},isTouchInside:function(touch){var touchLocation=this.getTouchLocation(touch);return this.distanceBetweenPointAndPoint(this._progressTimer.getPosition(),touchLocation)<Math.min(this.getContentSize().width/2,this.getContentSize().height/2)},onTouchBegan:function(touch,event){return!!(this.isTouchInside(touch)&&this.isEnabled()&&this.isVisible())&&(this._previousLocation=this.getTouchLocation(touch),this.potentiometerBegan(this._previousLocation),!0)},onTouchMoved:function(touch,event){var location=this.getTouchLocation(touch);this.potentiometerMoved(location)},onTouchEnded:function(touch,event){this.potentiometerEnded(cc.p(0,0))},distanceBetweenPointAndPoint:function(point1,point2){var dx=point1.x-point2.x,dy=point1.y-point2.y;return Math.sqrt(dx*dx+dy*dy)},angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint:function(beginLineA,endLineA,beginLineB,endLineB){var a=endLineA.x-beginLineA.x,b=endLineA.y-beginLineA.y,c=endLineB.x-beginLineB.x,d=endLineB.y-beginLineB.y;return 180*(Math.atan2(a,b)-Math.atan2(c,d))/Math.PI},potentiometerBegan:function(location){this.setSelected(!0),this.getThumbSprite().setColor(cc.color.GRAY)},potentiometerMoved:function(location){var angle=this.angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint(this._progressTimer.getPosition(),location,this._progressTimer.getPosition(),this._previousLocation);180<angle?angle-=360:angle<-180&&(angle+=360),this.setValue(this._value+angle/360*(this._maximumValue-this._minimumValue)),this._previousLocation=location},potentiometerEnded:function(location){this.getThumbSprite().setColor(cc.color.WHITE),this.setSelected(!1)},setThumbSprite:function(sprite){this._thumbSprite=sprite},getThumbSprite:function(){return this._thumbSprite},setProgressTimer:function(sprite){this._progressTimer=sprite},getProgressTimer:function(){return this._progressTimer},setPreviousLocation:function(point){this._previousLocation=point},getPreviousLocation:function(){return this._previousLocation}}),(_p=cc.ControlPotentiometer.prototype).value,cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue),_p.minValue,cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue),_p.maxValue,cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue),_p.progressTimer,cc.defineGetterSetter(_p,"progressTimer",_p.getProgressTimer,_p.setProgressTimer),_p.thumbSprite,cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite,_p.setThumbSprite),_p.prevLocation,cc.defineGetterSetter(_p,"prevLocation",_p.getPreviousLocation,_p.setPreviousLocation),_p=null,cc.ControlPotentiometer.create=function(backgroundFile,progressFile,thumbFile){return new cc.ControlPotentiometer(backgroundFile,progressFile,thumbFile)},cc.SCROLLVIEW_DIRECTION_NONE=-1,cc.SCROLLVIEW_DIRECTION_HORIZONTAL=0,cc.SCROLLVIEW_DIRECTION_VERTICAL=1,cc.SCROLLVIEW_DIRECTION_BOTH=2;var SCROLL_DEACCEL_RATE=.95,SCROLL_DEACCEL_DIST=1,BOUNCE_DURATION=.15,INSET_RATIO=.2,MOVE_INCH=1/160,BOUNCE_BACK_FACTOR=.35;cc.convertDistanceFromPointToInch=function(pointDis){var eglViewer=cc.view;return pointDis*((eglViewer.getScaleX()+eglViewer.getScaleY())/2)/160},cc.ScrollViewDelegate=cc.Class.extend({scrollViewDidScroll:function(view){},scrollViewDidZoom:function(view){}}),cc.ScrollView=cc.Layer.extend({_zoomScale:0,_minZoomScale:0,_maxZoomScale:0,_delegate:null,_direction:cc.SCROLLVIEW_DIRECTION_BOTH,_dragging:!1,_contentOffset:null,_container:null,_touchMoved:!1,_maxInset:null,_minInset:null,_bounceable:!1,_clippingToBounds:!1,_scrollDistance:null,_touchPoint:null,_touchLength:0,_touches:null,_viewSize:null,_minScale:0,_maxScale:0,_parentScissorRect:null,_scissorRestored:!1,_tmpViewRect:null,_touchListener:null,_className:"ScrollView",m_pScrollBar:null,m_bShowScrollBar:!1,m_bAutoHIde:!1,m_bDynamic:!1,m_restrictScrollArea:!1,ctor:function(size,container){cc.Layer.prototype.ctor.call(this),this._contentOffset=cc.p(0,0),this._maxInset=cc.p(0,0),this._minInset=cc.p(0,0),this._scrollDistance=cc.p(0,0),this._touchPoint=cc.p(0,0),this._touches=[],this._viewSize=cc.size(0,0),this._parentScissorRect=new cc.Rect(0,0,0,0),this._tmpViewRect=new cc.Rect(0,0,0,0),null!=container?this.initWithViewSize(size,container):this.initWithViewSize(cc.size(200,200),null)},init:function(){return this.initWithViewSize(cc.size(200,200),null)},initWithViewSize:function(size,container){var pZero=cc.p(0,0);return!!cc.Layer.prototype.init.call(this)&&(container||this._container||(container=new cc.Layer),container&&this.setContainer(container),this.setViewSize(size),this.setTouchEnabled(!0),this._touches.length=0,this._delegate=null,this._bounceable=!0,this._clippingToBounds=!0,this._direction=cc.SCROLLVIEW_DIRECTION_BOTH,this._container.setPosition(pZero),this._touchLength=0,this._minScale=this._maxScale=1,!0)},visit:function(parent){if(this._visible){var renderer=cc.renderer,cmd=this._renderCmd;cmd.visit(parent&&parent._renderCmd),this._clippingToBounds&&renderer.pushRenderCommand(cmd.startCmd);var i,children=this._children,len=children.length;if(0<len)for(this._reorderChildDirty&&this.sortAllChildren(),i=0;i<len;i++)children[i].visit(this);this._clippingToBounds&&renderer.pushRenderCommand(cmd.endCmd),cmd._dirtyFlag=0}},setContentOffset:function(offset,animated){if(1==this.m_restrictScrollArea){var minOffset=this.minContainerOffset();if(0<offset.y||offset.y<minOffset.y)return}if(animated)this.setContentOffsetInDuration(offset,BOUNCE_DURATION);else{if(!this._bounceable){minOffset=this.minContainerOffset();var maxOffset=this.maxContainerOffset();offset.x=Math.max(minOffset.x,Math.min(maxOffset.x,offset.x)),offset.y=Math.max(minOffset.y,Math.min(maxOffset.y,offset.y))}this._container.setPosition(offset);var locDelegate=this._delegate;null!=locDelegate&&locDelegate.scrollViewDidScroll&&(locDelegate.scrollViewDidScroll(this),this.m_bShowScrollBar&&null!=this.m_pScrollBar&&this.m_pScrollBar.setBarRefresh())}},getContentOffset:function(){var locPos=this._container.getPosition();return cc.p(locPos.x,locPos.y)},scrollToPercentVertical:function(percent,time,attenuated){percent/=5,cc.log("delta : ================="+percent);var duration=cc.p(0,percent);this._scrollDistance=duration,this.schedule(this._deaccelerateScrolling)},setContentOffsetInDuration:function(offset,dt){var scroll=cc.moveTo(dt,offset),expire=cc.callFunc(this._stoppedAnimatedScroll,this);this._container.runAction(cc.sequence(scroll,expire)),this.schedule(this._performedAnimatedScroll)},setZoomScale:function(scale,animated){if(animated)this.setZoomScaleInDuration(scale,BOUNCE_DURATION);else{var locContainer=this._container;if(locContainer.getScale()!==scale){var oldCenter,newCenter,center;if(0===this._touchLength){var locViewSize=this._viewSize;center=cc.p(.5*locViewSize.width,.5*locViewSize.height),center=this.convertToWorldSpace(center)}else center=this._touchPoint;oldCenter=locContainer.convertToNodeSpace(center),locContainer.setScale(Math.max(this._minScale,Math.min(this._maxScale,scale))),newCenter=locContainer.convertToWorldSpace(oldCenter);var offset=cc.pSub(center,newCenter);this._delegate&&this._delegate.scrollViewDidZoom&&this._delegate.scrollViewDidZoom(this),this.setContentOffset(cc.pAdd(locContainer.getPosition(),offset))}}},getZoomScale:function(){return this._container.getScale()},setZoomScaleInDuration:function(s,dt){if(0<dt){var locScale=this._container.getScale();if(locScale!==s){var scaleAction=cc.actionTween(dt,"zoomScale",locScale,s);this.runAction(scaleAction)}}else this.setZoomScale(s)},minContainerOffset:function(){var locContainer=this._container,locContentSize=locContainer.getContentSize(),locViewSize=this._viewSize;return cc.p(locViewSize.width-locContentSize.width*locContainer.getScaleX(),locViewSize.height-locContentSize.height*locContainer.getScaleY())},maxContainerOffset:function(){return cc.p(0,0)},isNodeVisible:function(node){var offset=this.getContentOffset(),size=this.getViewSize(),scale=this.getZoomScale(),viewRect=cc.rect(-offset.x/scale,-offset.y/scale,size.width/scale,size.height/scale);return cc.rectIntersectsRect(viewRect,node.getBoundingBox())},pause:function(sender){this._container.pause();for(var selChildren=this._container.getChildren(),i=0;i<selChildren.length;i++)selChildren[i].pause();this._super()},resume:function(sender){for(var selChildren=this._container.getChildren(),i=0,len=selChildren.length;i<len;i++)selChildren[i].resume();this._container.resume(),this._super()},isDragging:function(){return this._dragging},isTouchMoved:function(){return this._touchMoved},isBounceable:function(){return this._bounceable},setBounceable:function(bounceable){this._bounceable=bounceable},setScrollRestriction:function(enable_restrict){this.m_restrictScrollArea=enable_restrict},getViewSize:function(){return this._viewSize},setViewSize:function(size){this._viewSize=size,cc.Node.prototype.setContentSize.call(this,size)},getContainer:function(){return this._container},setContainer:function(container){container&&(this.removeAllChildren(!0),(this._container=container).ignoreAnchorPointForPosition(!1),container.setAnchorPoint(0,0),this.addChild(container),this.setViewSize(this._viewSize))},getDirection:function(){return this._direction},setDirection:function(direction){this._direction=direction},getDelegate:function(){return this._delegate},setDelegate:function(delegate){this._delegate=delegate},onTouchBegan:function(touch,event){for(var c=this;null!=c;c=c.parent)if(!c.isVisible())return!1;var frame=this._getViewRect(),locContainer=this._container,locPoint=locContainer.convertToWorldSpace(locContainer.convertTouchToNodeSpace(touch)),locTouches=this._touches;return!(2<locTouches.length||this._touchMoved||!cc.rectContainsPoint(frame,locPoint))&&(locTouches.push(touch),1===locTouches.length?(this._touchPoint=this.convertTouchToNodeSpace(touch),this._touchMoved=!1,this._dragging=!0,this._scrollDistance.x=0,this._scrollDistance.y=0,this._touchLength=0):2===locTouches.length&&(this._touchPoint=cc.pMidpoint(this.convertTouchToNodeSpace(locTouches[0]),this.convertTouchToNodeSpace(locTouches[1])),this._touchLength=cc.pDistance(locContainer.convertTouchToNodeSpace(locTouches[0]),locContainer.convertTouchToNodeSpace(locTouches[1])),this._dragging=!1),!0)},onTouchMoved:function(touch,event){if(this.isVisible())if(this.setNodeDirty(),1===this._touches.length&&this._dragging){this._getViewRect();var pos,newPoint=this.convertTouchToNodeSpace(touch),moveDistance=cc.pSub(newPoint,this._touchPoint),dis=0,locDirection=this._direction;if(locDirection===cc.SCROLLVIEW_DIRECTION_VERTICAL)dis=moveDistance.y,pos=this._container.getPositionY(),this.minContainerOffset().y<=pos&&pos<=this.maxContainerOffset().y||(moveDistance.y*=BOUNCE_BACK_FACTOR);else if(locDirection===cc.SCROLLVIEW_DIRECTION_HORIZONTAL)dis=moveDistance.x,pos=this._container.getPositionX(),this.minContainerOffset().x<=pos&&pos<=this.maxContainerOffset().x||(moveDistance.x*=BOUNCE_BACK_FACTOR);else{dis=Math.sqrt(moveDistance.x*moveDistance.x+moveDistance.y*moveDistance.y),pos=this._container.getPositionY();var _minOffset=this.minContainerOffset(),_maxOffset=this.maxContainerOffset();_minOffset.y<=pos&&pos<=_maxOffset.y||(moveDistance.y*=BOUNCE_BACK_FACTOR),pos=this._container.getPositionX(),_minOffset.x<=pos&&pos<=_maxOffset.x||(moveDistance.x*=BOUNCE_BACK_FACTOR)}if(this._dragging&&Math.abs(cc.convertDistanceFromPointToInch(dis))>MOVE_INCH&&(this._touchMoved=!0),this._touchMoved||(moveDistance.x=0,moveDistance.y=0),this._touchPoint=newPoint,this._dragging&&1==this._touchMoved){switch(locDirection){case cc.SCROLLVIEW_DIRECTION_VERTICAL:moveDistance.x=0;break;case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:moveDistance.y=0}var locPosition=this._container.getPosition(),newX=locPosition.x+moveDistance.x,newY=locPosition.y+moveDistance.y;this._scrollDistance=moveDistance,this.setContentOffset(cc.p(newX,newY))}}else if(2===this._touches.length&&!this._dragging){var len=cc.pDistance(this._container.convertTouchToNodeSpace(this._touches[0]),this._container.convertTouchToNodeSpace(this._touches[1]));this.setZoomScale(this.getZoomScale()*len/this._touchLength)}},onTouchEnded:function(touch,event){this.isVisible()&&(1===this._touches.length&&this._touchMoved&&this.schedule(this._deaccelerateScrolling),this._touches.length=0,this._dragging=!1,this._touchMoved=!1)},onTouchCancelled:function(touch,event){this.isVisible()&&(this._touches.length=0,this._dragging=!1,this._touchMoved=!1)},setContentSize:function(size,height){null!==this.getContainer()&&(void 0===height?this.getContainer().setContentSize(size):this.getContainer().setContentSize(size,height),this.updateInset())},_setWidth:function(value){var container=this.getContainer();null!==container&&(container._setWidth(value),this.updateInset())},_setHeight:function(value){var container=this.getContainer();null!==container&&(container._setHeight(value),this.updateInset())},getContentSize:function(){return this._container.getContentSize()},updateInset:function(){if(null!==this.getContainer()){var locViewSize=this._viewSize,tempOffset=this.maxContainerOffset();this._maxInset.x=tempOffset.x+locViewSize.width*INSET_RATIO,this._maxInset.y=tempOffset.y+locViewSize.height*INSET_RATIO,tempOffset=this.minContainerOffset(),this._minInset.x=tempOffset.x-locViewSize.width*INSET_RATIO,this._minInset.y=tempOffset.y-locViewSize.height*INSET_RATIO}},isClippingToBounds:function(){return this._clippingToBounds},setClippingToBounds:function(clippingToBounds){this._clippingToBounds=clippingToBounds},addChild:function(child,zOrder,tag){if(!child)throw new Error("child must not nil!");zOrder=zOrder||child.getLocalZOrder(),tag=tag||child.getTag(),this._container!==child?this._container.addChild(child,zOrder,tag):cc.Layer.prototype.addChild.call(this,child,zOrder,tag)},isTouchEnabled:function(){return null!==this._touchListener},setTouchEnabled:function(e){if(this._touchListener&&cc.eventManager.removeListener(this._touchListener),this._touchListener=null,e){var listener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE});this.onTouchBegan&&(listener.onTouchBegan=this.onTouchBegan.bind(this)),this.onTouchMoved&&(listener.onTouchMoved=this.onTouchMoved.bind(this)),this.onTouchEnded&&(listener.onTouchEnded=this.onTouchEnded.bind(this)),this.onTouchCancelled&&(listener.onTouchCancelled=this.onTouchCancelled.bind(this)),this._touchListener=listener,cc.eventManager.addListener(listener,this)}else this._dragging=!1,this._touchMoved=!1,this._touches.length=0},_initWithViewSize:function(size){return null},_relocateContainer:function(animated){var min=this.minContainerOffset(),max=this.maxContainerOffset(),locDirection=this._direction,oldPoint=this._container.getPosition(),newX=oldPoint.x,newY=oldPoint.y;locDirection!==cc.SCROLLVIEW_DIRECTION_BOTH&&locDirection!==cc.SCROLLVIEW_DIRECTION_HORIZONTAL||(newX=Math.max(newX,min.x),newX=Math.min(newX,max.x)),locDirection!==cc.SCROLLVIEW_DIRECTION_BOTH&&locDirection!==cc.SCROLLVIEW_DIRECTION_VERTICAL||(newY=Math.min(newY,max.y),newY=Math.max(newY,min.y)),newY===oldPoint.y&&newX===oldPoint.x||this.setContentOffset(cc.p(newX,newY),animated)},_deaccelerateScrolling:function(dt){if(this._dragging)this.unschedule(this._deaccelerateScrolling);else{var maxInset,minInset,oldPosition=this._container.getPosition(),locScrollDistance=this._scrollDistance;this._container.setPosition(oldPosition.x+locScrollDistance.x,oldPosition.y+locScrollDistance.y),minInset=this._bounceable?(maxInset=this._maxInset,this._minInset):(maxInset=this.maxContainerOffset(),this.minContainerOffset());var newX=this._container.getPositionX(),newY=this._container.getPositionY();1==this.m_restrictScrollArea&&(0<newY?(newY=0,this.unschedule(this._deaccelerateScrolling)):newY<minInset.y+150&&(newY=minInset.y+150,this.unschedule(this._deaccelerateScrolling))),locScrollDistance.x=locScrollDistance.x*SCROLL_DEACCEL_RATE,locScrollDistance.y=locScrollDistance.y*SCROLL_DEACCEL_RATE,this.setContentOffset(cc.p(newX,newY)),(Math.abs(locScrollDistance.x)<=SCROLL_DEACCEL_DIST&&Math.abs(locScrollDistance.y)<=SCROLL_DEACCEL_DIST||newY>maxInset.y||newY<minInset.y||newX>maxInset.x||newX<minInset.x||newX===maxInset.x||newX===minInset.x||newY===maxInset.y||newY===minInset.y)&&(this.unschedule(this._deaccelerateScrolling),this._relocateContainer(!0),this.m_bShowScrollBar&&null!=this.m_pScrollBar&&this.m_pScrollBar.IsAutoHide()&&this.m_pScrollBar.hide())}},_performedAnimatedScroll:function(dt){this._dragging?this.unschedule(this._performedAnimatedScroll):this._delegate&&this._delegate.scrollViewDidScroll&&(this._delegate.scrollViewDidScroll(this),this.m_bShowScrollBar&&null!=this.m_pScrollBar&&this.m_pScrollBar.setBarRefresh())},_stoppedAnimatedScroll:function(node){this.unschedule(this._performedAnimatedScroll),this._delegate&&this._delegate.scrollViewDidScroll&&(this._delegate.scrollViewDidScroll(this),this.m_bShowScrollBar&&null!=this.m_pScrollBar&&this.m_pScrollBar.setBarRefresh())},_handleZoom:function(){},_getViewRect:function(){for(var screenPos=this.convertToWorldSpace(cc.p(0,0)),locViewSize=this._viewSize,scaleX=this.getScaleX(),scaleY=this.getScaleY(),p=this._parent;null!=p;p=p.getParent())scaleX*=p.getScaleX(),scaleY*=p.getScaleY();scaleX<0&&(screenPos.x+=locViewSize.width*scaleX,scaleX=-scaleX),scaleY<0&&(screenPos.y+=locViewSize.height*scaleY,scaleY=-scaleY);var locViewRect=this._tmpViewRect;return locViewRect.x=screenPos.x,locViewRect.y=screenPos.y,locViewRect.width=locViewSize.width*scaleX,locViewRect.height=locViewSize.height*scaleY,locViewRect},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.ScrollView.CanvasRenderCmd(this):new cc.ScrollView.WebGLRenderCmd(this)},scrollBarEnable:function(bEnable){this.m_bShowScrollBar=bEnable,this.m_bShowScrollBar?null==this.m_pScrollBar&&(this.m_pScrollBar=new ScrollBar(this,-1),this.m_pScrollBar.setDynamicScrollSize(this.m_bDynamic),this.m_pScrollBar.setAutoHide(this.m_bAutoHIde)):null!=this.m_pScrollBar&&this.m_pScrollBar.hide()},setAutoHideScrollBar:function(bAutoHide){this.m_bAutoHIde=bAutoHide,null!=this.m_pScrollBar&&this.m_pScrollBar.setAutoHide(bAutoHide)},setDynamicScrollBar:function(bDynamic){this.m_bDynamic=bDynamic,null!=this.m_pScrollBar&&this.m_pScrollBar.setDynamicScrollSize(bDynamic)},setScrollBarWide:function(wide){null!=this.m_pScrollBar&&this.m_pScrollBar.setScrollBarWide(wide)},setScrollBarOpacity:function(opacity){null!=this.m_pScrollBar&&this.m_pScrollBar.setScrollBarOpacity(opacity)},setScrollBarColor:function(color){null!=this.m_pScrollBar&&this.m_pScrollBar.setScrollBarColor(color)},setScrollBarAlwaysShow:function(bShow){null!=this.m_pScrollBar&&this.m_pScrollBar.setScrollBarAlwaysShow(bShow)},setScrollBarMargin:function(_margin){null!=this.m_pScrollBar&&this.m_pScrollBar.setScrollBarMargin(_margin)},setScrollUpdateViewSize:function(){null!=this.m_pScrollBar&&this.m_pScrollBar.setScrollUpdateViewSize()}}),(_p=cc.ScrollView.prototype).minOffset,cc.defineGetterSetter(_p,"minOffset",_p.minContainerOffset),_p.maxOffset,cc.defineGetterSetter(_p,"maxOffset",_p.maxContainerOffset),_p.bounceable,cc.defineGetterSetter(_p,"bounceable",_p.isBounceable,_p.setBounceable),_p.viewSize,cc.defineGetterSetter(_p,"viewSize",_p.getViewSize,_p.setViewSize),_p.container,cc.defineGetterSetter(_p,"container",_p.getContainer,_p.setContainer),_p.direction,cc.defineGetterSetter(_p,"direction",_p.getDirection,_p.setDirection),_p.delegate,cc.defineGetterSetter(_p,"delegate",_p.getDelegate,_p.setDelegate),_p.clippingToBounds,cc.defineGetterSetter(_p,"clippingToBounds",_p.isClippingToBounds,_p.setClippingToBounds),_p=null,cc.ScrollView.create=function(size,container){return new cc.ScrollView(size,container)};var DEFAULT_BAR_COLOR=cc.color(166,158,167,255),barNonDynamicSize=130,AUTO_HIDE_TIME=.2,ScrollBar=cc.Layer.extend({m_dynamicScrollSize:!0,m_isAutoHide:!1,m_barV:null,m_barH:null,m_scrollView:null,m_bar_wide:4,m_bar_opacity:255,m_bar_color:null,m_isAlwaysShow:null,m_margin:0,m_viewSize:null,ctor:function(scrollView,offset){this._super(),this.m_dynamicScrollSize=!0,this.m_isAutoHide=!1,this.m_barV=null,this.m_barH=null,this.m_scrollView=null,this.m_bar_wide=4,this.m_bar_opacity=255,this.m_bar_color=cc.Color(166,158,167),this.m_isAlwaysShow=!1,this.m_margin=0,this.m_viewSize=cc.size(0,0),this.init(scrollView,offset)},init:function(scrollView,offset){return this.m_scrollView=scrollView,this.m_viewSize=this.m_scrollView.getViewSize(),this.m_barH=new cc.LayerColor(DEFAULT_BAR_COLOR),this.m_barH.ignoreAnchorPointForPosition(!1),this.m_barH.setAnchorPoint(cc.p(.5,0)),this.m_barH.setPosition(0,offset),this.addChild(this.m_barH),this.m_barV=new cc.LayerColor(DEFAULT_BAR_COLOR),this.m_barV.ignoreAnchorPointForPosition(!1),this.m_barV.setAnchorPoint(cc.p(1,.5)),this.m_barV.setPosition(offset,0),this.addChild(this.m_barV),scrollView.addChild(this,50),this.m_direction=this.m_scrollView.getDirection(),this.updateViewSize(),this.setBarRefreshH(),this.setBarRefreshV(),!0},setBarRefresh:function(offset){var direction=this.m_scrollView.getDirection();this.m_direction!=direction&&(this.m_direction=direction,this.updateViewSize()),direction==cc.SCROLLVIEW_DIRECTION_HORIZONTAL?(this.m_barH.isVisible()||this.m_barH.setVisible(!0),this.m_barV.isVisible()&&this.m_barV.setVisible(!1),this.setBarRefreshH()):direction==cc.SCROLLVIEW_DIRECTION_VERTICAL?(this.m_barH.isVisible()&&this.m_barH.setVisible(!1),this.m_barV.isVisible()||this.m_barV.setVisible(!0),this.setBarRefreshV(offset)):direction==cc.SCROLLVIEW_DIRECTION_BOTH&&(this.m_barH.isVisible()||this.m_barH.setVisible(!1),this.m_barV.isVisible()||this.m_barV.setVisible(!0),this.setBarRefreshH(),this.setBarRefreshV())},setAutoHide:function(isAuto){this.m_isAutoHide=isAuto},IsAutoHide:function(){return this.m_isAutoHide},setDynamicScrollSize:function(bool){this.m_dynamicScrollSize=bool,this.setBarRefresh()},setBarRefreshH:function(){if(this.m_barH.isVisible()){var viewSize=this.m_scrollView.getViewSize(),contentSize=this.m_scrollView.getContainer().getContentSize(),scrollBarSize=viewSize.width/contentSize.width*viewSize.width;scrollBarSize=Math.min(viewSize.width,scrollBarSize);var total=contentSize.width-viewSize.width;this.m_dynamicScrollSize?this.m_barH.setContentSize(cc.size(scrollBarSize,this.m_bar_wide)):this.m_barH.setContentSize(cc.size(barNonDynamicSize,this.m_bar_wide));var barContentSize=this.m_barH.getContentSize(),offset=-this.m_scrollView.getContentOffset().x,offsetY=-this.m_scrollView.getContentOffset().y,percent=offset/total;percent=Math.min(1,percent);var position=(percent=(percent=Math.max(0,percent))*(viewSize.width-barContentSize.width)/viewSize.width)*viewSize.width+.5*barContentSize.width;this.m_barH.setPosition(cc.p(offset+position,offsetY-this.m_margin)),this.m_barH.getOpacity()<this.m_bar_opacity&&(this.m_barH.stopAllActions(),this.m_barH.setOpacity(this.m_bar_opacity))}},setBarRefreshV:function(vector){if(this.m_barV.isVisible()){var viewSize=this.m_scrollView.getViewSize(),contentSize=this.m_scrollView.getContainer().getContentSize(),scrollBarSize=viewSize.height/contentSize.height*viewSize.height;scrollBarSize=Math.min(viewSize.height,scrollBarSize);var total=contentSize.height-viewSize.height;this.m_dynamicScrollSize=!0,this.m_dynamicScrollSize?this.m_barV.setContentSize(cc.size(this.m_bar_wide,scrollBarSize)):this.m_barV.setContentSize(cc.size(this.m_bar_wide,barNonDynamicSize));var barContentSize=this.m_barV.getContentSize(),offset=-this.m_scrollView.getContentOffset().y,offsetX=-this.m_scrollView.getContentOffset().x,percent=offset/total;percent=Math.min(1,percent);var position=(percent=(percent=Math.max(0,percent))*(viewSize.height-barContentSize.height)/viewSize.height)*viewSize.height+.5*barContentSize.height;this.m_barV.setPosition(cc.p(offsetX+viewSize.width+this.m_margin,offset+position)),this.m_barV.getOpacity()<this.m_bar_opacity&&(this.m_barV.stopAllActions(),this.m_barV.setOpacity(this.m_bar_opacity))}},updateViewSize:function(){var direction=this.m_scrollView.getDirection();direction==cc.SCROLLVIEW_DIRECTION_HORIZONTAL?(this.m_scrollView.setViewSize(cc.size(this.m_viewSize.width,this.m_viewSize.height+this.m_bar_wide+this.m_margin)),this.m_scrollView.getContainer().setPositionY(this.m_bar_wide+this.m_margin)):direction==cc.SCROLLVIEW_DIRECTION_VERTICAL?this.m_scrollView.setViewSize(cc.size(this.m_viewSize.width+this.m_bar_wide+this.m_margin,this.m_viewSize.height)):direction==cc.SCROLLVIEW_DIRECTION_BOTH&&(this.m_scrollView.setViewSize(cc.size(this.m_viewSize.width+this.m_bar_wide+this.m_margin,this.m_viewSize.height+this.m_bar_wide+this.m_margin)),this.m_scrollView.getContainer().setPositionY(this.m_bar_wide+this.m_margin))},hide:function(){if(null!=this.m_barH){var fadeout=cc.fadeOut(AUTO_HIDE_TIME);this.m_barH.runAction(fadeout)}if(null!=this.m_barV){fadeout=cc.fadeOut(AUTO_HIDE_TIME);this.m_barV.runAction(fadeout)}},setScrollBarWide:function(bar_wide){this.m_bar_wide=bar_wide,this.updateViewSize(),this.setBarRefresh()},setScrollBarOpacity:function(opacity){this.m_bar_opacity=opacity,this.m_barH.setOpacity(this.m_bar_opacity),this.m_barV.setOpacity(this.m_bar_opacity),this.setBarRefresh()},setScrollBarColor:function(color){this.m_bar_color=color,this.m_barH.setColor(this.m_bar_color),this.m_barV.setColor(this.m_bar_color),this.setBarRefresh()},setScrollBarAlwaysShow:function(bShow){this.m_isAlwaysShow=bShow,this.setBarRefresh()},setScrollBarMargin:function(_margin){this.m_margin=_margin,this.setBarRefresh()}});!function(){cc.ScrollView.CanvasRenderCmd=function(renderable){this._layerCmdCtor(renderable),this._needDraw=!1,this.startCmd=new cc.CustomRenderCmd(this,this._startCmd),this.startCmd._canUseDirtyRegion=!0,this.endCmd=new cc.CustomRenderCmd(this,this._endCmd),this.endCmd._canUseDirtyRegion=!0};var proto=cc.ScrollView.CanvasRenderCmd.prototype=Object.create(cc.Layer.CanvasRenderCmd.prototype);proto.constructor=cc.ScrollView.CanvasRenderCmd,proto._startCmd=function(ctx,scaleX,scaleY){var node=this._node,wrapper=ctx||cc._renderContext,context=wrapper.getContext();if(wrapper.save(),node._clippingToBounds){this._scissorRestored=!1,wrapper.setTransform(this._worldTransform,scaleX,scaleY);var locScaleX=node.getScaleX(),locScaleY=node.getScaleY(),getWidth=node._viewSize.width*locScaleX,getHeight=node._viewSize.height*locScaleY;context.beginPath(),context.rect(0,0,getWidth,-getHeight),context.closePath(),context.clip()}},proto._endCmd=function(wrapper){(wrapper=wrapper||cc._renderContext).restore()}}(),function(){cc.ScrollView.WebGLRenderCmd=function(renderable){this._layerCmdCtor(renderable),this._needDraw=!1,this.startCmd=new cc.CustomRenderCmd(this,this._startCmd),this.endCmd=new cc.CustomRenderCmd(this,this._endCmd)};var proto=cc.ScrollView.WebGLRenderCmd.prototype=Object.create(cc.Layer.WebGLRenderCmd.prototype);proto.constructor=cc.ScrollView.WebGLRenderCmd,proto._startCmd=function(){var node=this._node,EGLViewer=cc.view,frame=node._getViewRect();if(EGLViewer.isScissorEnabled()){if(node._scissorRestored=!0,node._parentScissorRect=EGLViewer.getScissorRect(),cc.rectIntersection(frame,node._parentScissorRect)){var locPSRect=node._parentScissorRect,x=Math.max(frame.x,locPSRect.x),y=Math.max(frame.y,locPSRect.y),xx=Math.min(frame.x+frame.width,locPSRect.x+locPSRect.width),yy=Math.min(frame.y+frame.height,locPSRect.y+locPSRect.height);EGLViewer.setScissorInPoints(x,y,xx-x,yy-y)}}else{var ctx=cc._renderContext;ctx.enable(ctx.SCISSOR_TEST),EGLViewer.setScissorInPoints(frame.x,frame.y,frame.width,frame.height)}},proto._endCmd=function(){var node=this._node;if(node._scissorRestored){var rect=node._parentScissorRect;cc.view.setScissorInPoints(rect.x,rect.y,rect.width,rect.height)}else{var ctx=cc._renderContext;ctx.disable(ctx.SCISSOR_TEST)}}}(),cc.SortableObject=cc.Class.extend({setObjectID:function(objectId){},getObjectID:function(){return 0}}),cc.SortedObject=cc.SortableObject.extend({_objectID:0,ctor:function(){this._objectID=0},setObjectID:function(objectID){this._objectID=objectID},getObjectID:function(){return this._objectID}});var _p,_compareObject=function(val1,val2){return val1.getObjectID()-val2.getObjectID()};cc.ArrayForObjectSorting=cc.Class.extend({_saveObjectArr:null,ctor:function(){this._saveObjectArr=[]},insertSortedObject:function(addObject){if(!addObject)throw new Error("cc.ArrayForObjectSorting.insertSortedObject(): addObject should be non-null.");var idx=this.indexOfSortedObject(addObject);this.insertObject(addObject,idx)},removeSortedObject:function(delObject){if(0!==this.count()){var idx=this.indexOfSortedObject(delObject);if(idx<this.count()&&idx!==cc.INVALID_INDEX)this.objectAtIndex(idx).getObjectID()===delObject.getObjectID()&&this.removeObjectAtIndex(idx)}},setObjectID_ofSortedObject:function(tag,setObject){var idx=this.indexOfSortedObject(setObject);if(idx<this.count()&&idx!==cc.INVALID_INDEX){var foundObj=this.objectAtIndex(idx);foundObj.getObjectID()===setObject.getObjectID()&&(this.removeObjectAtIndex(idx),foundObj.setObjectID(tag),this.insertSortedObject(foundObj))}},objectWithObjectID:function(tag){if(0===this.count())return null;var foundObj=new cc.SortedObject;foundObj.setObjectID(tag);var idx=this.indexOfSortedObject(foundObj);return idx<this.count()&&idx!==cc.INVALID_INDEX&&(foundObj=this.objectAtIndex(idx)).getObjectID()!==tag&&(foundObj=null),foundObj},getObjectWithObjectID:function(tag){return null},indexOfSortedObject:function(idxObj){var idx=0;if(idxObj)for(var uPrevObjectID=0,uOfSortObjectID=idxObj.getObjectID(),locObjectArr=this._saveObjectArr,i=0;i<locObjectArr.length;i++){var curObjectID=locObjectArr[i].getObjectID();if(uOfSortObjectID===curObjectID||uPrevObjectID<=uOfSortObjectID&&uOfSortObjectID<curObjectID)break;uPrevObjectID=curObjectID,idx++}else idx=cc.INVALID_INDEX;return idx},count:function(){return this._saveObjectArr.length},lastObject:function(){var locObjectArr=this._saveObjectArr;return 0===locObjectArr.length?null:locObjectArr[locObjectArr.length-1]},objectAtIndex:function(idx){return this._saveObjectArr[idx]},addObject:function(addObj){this._saveObjectArr.push(addObj),this._saveObjectArr.sort(_compareObject)},removeObjectAtIndex:function(idx){this._saveObjectArr.splice(idx,1),this._saveObjectArr.sort(_compareObject)},insertObject:function(addObj,idx){this._saveObjectArr.splice(idx,0,addObj),this._saveObjectArr.sort(_compareObject)}}),cc.TABLEVIEW_FILL_TOPDOWN=0,cc.TABLEVIEW_FILL_BOTTOMUP=1,cc.TableViewCell=cc.Node.extend({_idx:0,_className:"TableViewCell",_pos_in_cell:null,_pos_in_world:null,getIdx:function(){return this._idx},setIdx:function(idx){this._idx=idx},reset:function(){this._idx=cc.INVALID_INDEX},setObjectID:function(idx){this._idx=idx},getObjectID:function(){return this._idx},setTouchPos:function(_pos){this._pos_in_cell=_pos},setTouchWorldPos:function(_pos){this._pos_in_world=_pos},getTouchWorldPos:function(){return this._pos_in_world},setTouchTablePos:function(_pos){this._pos_in_table=_pos},getTouchTablePos:function(){return this._pos_in_table},getTouchPos:function(){return this._pos_in_cell},resetPos:function(){this._pos_in_cell=cc.p(0,0),this._pos_in_world=cc.p(0,0),this._pos_in_table=cc.p(0,0)}}),(_p=cc.TableViewCell.prototype).objectId,cc.defineGetterSetter(_p,"objectId",_p.getObjectID,_p.setObjectID),_p=null,cc.TableViewDelegate=cc.ScrollViewDelegate.extend({tableCellTouched:function(table,cell){},tableCellHighlight:function(table,cell){},tableCellUnhighlight:function(table,cell){},tableCellWillRecycle:function(table,cell){}}),cc.TableViewDataSource=cc.Class.extend({tableCellSizeForIndex:function(table,idx){return this.cellSizeForTable(table)},cellSizeForTable:function(table){return cc.size(0,0)},tableCellAtIndex:function(table,idx){return null},numberOfCellsInTableView:function(table){return 0}}),cc.TableView=cc.ScrollView.extend({_vOrdering:null,_indices:null,_cellsFreed:null,_dataSource:null,_tableViewDelegate:null,_oldDirection:null,_cellsPositions:null,_touchedCell:null,ctor:function(dataSource,size,container){cc.ScrollView.prototype.ctor.call(this),this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE,this._cellsPositions=[],this.initWithViewSize(size,container),this.setDataSource(dataSource),this._updateCellPositions(),this._updateContentSize();var mouseListener=cc.EventListener.create({event:cc.EventListener.MOUSE});mouseListener.onMouseScroll=function(event){var touchLocation=event.getLocation(),bb=this._tmpViewRect,delta=cc.sys.isNative?6*event.getScrollY():-event.getScrollY(),h=-(this._contentSize.height-this._container.getContentSize().height),locContainer=this._container;if(!(this._container.getContentSize().height<this._contentSize.height)){if(!cc.rectContainsPoint(bb,touchLocation))return!1;var percentY=(h+(locContainer.getPositionY()-locContainer._getAnchorY()*locContainer.height))/h*100,scrollSpeed=this._container.getContentSize().height/100;return this._scrolledPercent=percentY,this._scrolledPercent+delta/scrollSpeed<0?this._scrolledPercent=0:100<this._scrolledPercent+delta/scrollSpeed?this._scrolledPercent=100:this._scrolledPercent+=delta/scrollSpeed,this._scrolledPercent<=100&&0<=this._scrolledPercent&&(delta<0&&(scrollSpeed*=-1),delta+=.4*scrollSpeed,this.scrollToPercentVertical(delta,.2,!0)),!0}}.bind(this),cc.eventManager.addListener(mouseListener,this)},__indexFromOffset:function(offset){var search,low=0,high=this._dataSource.numberOfCellsInTableView(this)-1;switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:search=offset.x;break;default:search=offset.y}for(var locCellsPositions=this._cellsPositions;low<=high;){var index=0|low+(high-low)/2,cellStart=locCellsPositions[index],cellEnd=locCellsPositions[index+1];if(cellStart<=search&&search<=cellEnd)return index;search<cellStart?high=index-1:low=index+1}return low<=0?0:-1},_indexFromOffset:function(offset){var locOffset={x:offset.x,y:offset.y},maxIdx=this._dataSource.numberOfCellsInTableView(this)-1;this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(locOffset.y=this.getContainer().getContentSize().height-locOffset.y);var index=this.__indexFromOffset(locOffset);return-1!==index&&maxIdx<(index=Math.max(0,index))&&(index=cc.INVALID_INDEX),index},__offsetFromIndex:function(index){var offset;switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:offset=cc.p(this._cellsPositions[index],0);break;default:offset=cc.p(0,this._cellsPositions[index])}return offset},_offsetFromIndex:function(index){var offset=this.__offsetFromIndex(index),cellSize=this._dataSource.tableCellSizeForIndex(this,index);return this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(offset.y=this.getContainer().getContentSize().height-offset.y-cellSize.height),offset},_updateCellPositions:function(){var cellsCount=this._dataSource.numberOfCellsInTableView(this),locCellsPositions=this._cellsPositions;if(0<cellsCount){for(var cellSize,currentPos=0,locDataSource=this._dataSource,i=0;i<cellsCount;i++)switch(locCellsPositions[i]=currentPos,cellSize=locDataSource.tableCellSizeForIndex(this,i),this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:currentPos+=cellSize.width;break;default:currentPos+=cellSize.height}this._cellsPositions[cellsCount]=currentPos}},_updateContentSize:function(){var size=cc.size(0,0),cellsCount=this._dataSource.numberOfCellsInTableView(this);if(0<cellsCount){var maxPosition=this._cellsPositions[cellsCount];switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:size=cc.size(maxPosition,this._viewSize.height);break;default:size=cc.size(this._viewSize.width,maxPosition)}}this.setContentSize(size),this._oldDirection!==this._direction&&(this._direction===cc.SCROLLVIEW_DIRECTION_HORIZONTAL?this.setContentOffset(cc.p(0,0)):this.setContentOffset(cc.p(0,this.minContainerOffset().y)),this._oldDirection=this._direction)},_moveCellOutOfSight:function(cell){this._tableViewDelegate&&this._tableViewDelegate.tableCellWillRecycle&&this._tableViewDelegate.tableCellWillRecycle(this,cell),this._cellsFreed.addObject(cell),this._cellsUsed.removeSortedObject(cell),cc.arrayRemoveObject(this._indices,cell.getIdx()),cell.reset(),cell.getParent()===this.getContainer()&&this.getContainer().removeChild(cell,!0)},_setIndexForCell:function(index,cell){cell.setAnchorPoint(0,0),cell.setPosition(this._offsetFromIndex(index)),cell.setIdx(index)},_addCellIfNecessary:function(cell){cell.getParent()!==this.getContainer()&&this.getContainer().addChild(cell),this._cellsUsed.insertSortedObject(cell);var locIndices=this._indices,addIdx=cell.getIdx();-1===locIndices.indexOf(addIdx)&&(locIndices.push(addIdx),locIndices.sort(function(a,b){return a-b}))},getDataSource:function(){return this._dataSource},setDataSource:function(source){this._dataSource=source},getDelegate:function(){return this._tableViewDelegate},setDelegate:function(delegate){this._tableViewDelegate=delegate},setVerticalFillOrder:function(fillOrder){this._vOrdering!==fillOrder&&(this._vOrdering=fillOrder,0<this._cellsUsed.count()&&this.reloadData())},getVerticalFillOrder:function(){return this._vOrdering},initWithViewSize:function(size,container){return!!cc.ScrollView.prototype.initWithViewSize.call(this,size,container)&&(this._cellsUsed=new cc.ArrayForObjectSorting,this._cellsFreed=new cc.ArrayForObjectSorting,this._indices=[],this._tableViewDelegate=null,this._vOrdering=cc.TABLEVIEW_FILL_BOTTOMUP,this.setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL),cc.ScrollView.prototype.setDelegate.call(this,this),!0)},updateCellAtIndex:function(idx){if(!(idx===cc.INVALID_INDEX||idx>this._dataSource.numberOfCellsInTableView(this)-1)){var cell=this.cellAtIndex(idx);cell&&this._moveCellOutOfSight(cell),cell=this._dataSource.tableCellAtIndex(this,idx),this._setIndexForCell(idx,cell),this._addCellIfNecessary(cell)}},insertCellAtIndex:function(idx){if(!(idx===cc.INVALID_INDEX||idx>this._dataSource.numberOfCellsInTableView(this)-1)){var locCellsUsed=this._cellsUsed,cell=locCellsUsed.objectWithObjectID(idx);if(cell)for(var i=locCellsUsed.indexOfSortedObject(cell);i<locCellsUsed.count();i++)cell=locCellsUsed.objectAtIndex(i),this._setIndexForCell(cell.getIdx()+1,cell);cell=this._dataSource.tableCellAtIndex(this,idx),this._setIndexForCell(idx,cell),this._addCellIfNecessary(cell),this._updateCellPositions(),this._updateContentSize()}},removeCellAtIndex:function(idx){if(!(idx===cc.INVALID_INDEX||idx>this._dataSource.numberOfCellsInTableView(this)-1)){var cell=this.cellAtIndex(idx);if(cell){var locCellsUsed=this._cellsUsed,newIdx=locCellsUsed.indexOfSortedObject(cell);this._moveCellOutOfSight(cell),cc.arrayRemoveObject(this._indices,idx),this._updateCellPositions();for(var i=locCellsUsed.count()-1;newIdx<i;i--)cell=locCellsUsed.objectAtIndex(i),this._setIndexForCell(cell.getIdx()-1,cell)}}},reloadData:function(){this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE;for(var locCellsUsed=this._cellsUsed,locCellsFreed=this._cellsFreed,locContainer=this.getContainer(),i=0,len=locCellsUsed.count();i<len;i++){var cell=locCellsUsed.objectAtIndex(i);this._tableViewDelegate&&this._tableViewDelegate.tableCellWillRecycle&&this._tableViewDelegate.tableCellWillRecycle(this,cell),locCellsFreed.addObject(cell),cell.reset(),cell.getParent()===locContainer&&locContainer.removeChild(cell,!0)}this._indices=[],this._cellsUsed=new cc.ArrayForObjectSorting,this._updateCellPositions(),this._updateContentSize(),0<this._dataSource.numberOfCellsInTableView(this)&&this.scrollViewDidScroll(this),this.setNodeDirty()},dequeueCell:function(){if(0===this._cellsFreed.count())return null;var cell=this._cellsFreed.objectAtIndex(0);return this._cellsFreed.removeObjectAtIndex(0),cell},cellAtIndex:function(idx){return-1===this._indices.indexOf(idx)?null:this._cellsUsed.objectWithObjectID(idx)},scrollViewDidScroll:function(view){var countOfItems=this._dataSource.numberOfCellsInTableView(this);if(0!==countOfItems){null!==this._tableViewDelegate&&this._tableViewDelegate.scrollViewDidScroll&&this._tableViewDelegate.scrollViewDidScroll(this);var idx=0,locViewSize=this._viewSize,locContainer=this.getContainer(),offset=this.getContentOffset();offset.x*=-1,offset.y*=-1;var maxIdx=Math.max(countOfItems-1,0);this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(offset.y=offset.y+locViewSize.height/locContainer.getScaleY());var startIdx=this._indexFromOffset(offset);startIdx===cc.INVALID_INDEX&&(startIdx=countOfItems-1),this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN?offset.y-=locViewSize.height/locContainer.getScaleY():offset.y+=locViewSize.height/locContainer.getScaleY(),offset.x+=locViewSize.width/locContainer.getScaleX();var endIdx=this._indexFromOffset(offset);endIdx===cc.INVALID_INDEX&&(endIdx=countOfItems-1);var cell,locCellsUsed=this._cellsUsed;if(0<locCellsUsed.count())for(idx=(cell=locCellsUsed.objectAtIndex(0)).getIdx();idx<startIdx&&(this._moveCellOutOfSight(cell),0<locCellsUsed.count());)idx=(cell=locCellsUsed.objectAtIndex(0)).getIdx();if(0<locCellsUsed.count())for(idx=(cell=locCellsUsed.lastObject()).getIdx();idx<=maxIdx&&endIdx<idx&&(this._moveCellOutOfSight(cell),0<locCellsUsed.count());)idx=(cell=locCellsUsed.lastObject()).getIdx();for(var locIndices=this._indices,i=startIdx;i<=endIdx;i++)-1===locIndices.indexOf(i)&&this.updateCellAtIndex(i)}},scrollViewDidZoom:function(view){},onTouchEnded:function(touch,event){if(this.isVisible()){if(this._touchedCell){var bb=this.getBoundingBox(),tmpOrigin=cc.p(bb.x,bb.y);tmpOrigin=this._parent.convertToWorldSpace(tmpOrigin),bb.x=tmpOrigin.x,bb.y=tmpOrigin.y;var locTableViewDelegate=this._tableViewDelegate;if(cc.rectContainsPoint(bb,touch.getLocation())&&null!==locTableViewDelegate){var pos=this._touchedCell.convertToNodeSpace(touch.getLocation()),table_pos=this.convertToNodeSpace(touch.getLocation()),world_pos=this._touchedCell.convertToWorldSpace(pos);this._touchedCell.setTouchPos(pos),this._touchedCell.setTouchTablePos(table_pos),this._touchedCell.setTouchWorldPos(world_pos),locTableViewDelegate.tableCellUnhighlight&&locTableViewDelegate.tableCellUnhighlight(this,this._touchedCell),locTableViewDelegate.tableCellTouched&&locTableViewDelegate.tableCellTouched(this,this._touchedCell)}this._touchedCell.resetPos(),this._touchedCell=null}else null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellEnded(null);null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellEnded(this),cc.ScrollView.prototype.onTouchEnded.call(this,touch,event)}},onTouchBegan:function(touch,event){for(var c=this;null!=c;c=c.parent)if(!c.isVisible())return!1;var touchResult=cc.ScrollView.prototype.onTouchBegan.call(this,touch,event);if(1===this._touches.length){var index,point;if(point=this.getContainer().convertTouchToNodeSpace(touch),(index=this._indexFromOffset(point))===cc.INVALID_INDEX?this._touchedCell=null:this._touchedCell=this.cellAtIndex(index),this._touchedCell){var bb=this.getBoundingBox(),tmpOrigin=cc.p(bb.x,bb.y);tmpOrigin=this._parent.convertToWorldSpace(tmpOrigin),bb.x=tmpOrigin.x,bb.y=tmpOrigin.y;var locTableViewDelegate=this._tableViewDelegate;if(cc.rectContainsPoint(bb,touch.getLocation())&&null!==locTableViewDelegate&&null!=this._touchedCell){var pos=this._touchedCell.convertToNodeSpace(touch.getLocation()),table_pos=this.convertToNodeSpace(touch.getLocation()),world_pos=this._touchedCell.convertToWorldSpace(pos);this._touchedCell.setTouchPos(pos),this._touchedCell.setTouchTablePos(table_pos),this._touchedCell.setTouchWorldPos(world_pos)}}this._touchedCell&&null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellHighlight(this,this._touchedCell)}else if(this._touchedCell){bb=this.getBoundingBox(),tmpOrigin=cc.p(bb.x,bb.y);if(tmpOrigin=this._parent.convertToWorldSpace(tmpOrigin),bb.x=tmpOrigin.x,bb.y=tmpOrigin.y,cc.rectContainsPoint(bb,touch.getLocation())){pos=this._touchedCell.convertToNodeSpace(touch.getLocation()),table_pos=this.convertToNodeSpace(touch.getLocation()),world_pos=this._touchedCell.convertToWorldSpace(pos);this._touchedCell.setTouchPos(pos),this._touchedCell.setTouchTablePos(table_pos),this._touchedCell.setTouchWorldPos(world_pos)}null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null}return touchResult},onTouchMoved:function(touch,event){if(cc.ScrollView.prototype.onTouchMoved.call(this,touch,event),this._touchedCell&&this.isTouchMoved()){var bb=this.getBoundingBox(),tmpOrigin=cc.p(bb.x,bb.y);if(tmpOrigin=this._parent.convertToWorldSpace(tmpOrigin),bb.x=tmpOrigin.x,bb.y=tmpOrigin.y,cc.rectContainsPoint(bb,touch.getLocation())){var pos=this._touchedCell.convertToNodeSpace(touch.getLocation()),table_pos=this.convertToNodeSpace(touch.getLocation()),world_pos=this._touchedCell.convertToWorldSpace(pos);this._touchedCell.setTouchPos(pos),this._touchedCell.setTouchTablePos(table_pos),this._touchedCell.setTouchWorldPos(world_pos)}null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null}},onTouchCancelled:function(touch,event){cc.ScrollView.prototype.onTouchCancelled.call(this,touch,event),this._touchedCell&&(null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null)},getCellsUsed:function(){return this._cellsUsed._saveObjectArr},setTouchScrollEnabled:function(enabled){this.setTouchEnabled(enabled)}}),(_p=cc.TableView.prototype).dataSource,cc.defineGetterSetter(_p,"dataSource",_p.getDataSource,_p.setDataSource),_p.delegate,cc.defineGetterSetter(_p,"delegate",_p.getDelegate,_p.setDelegate),_p.verticalFillOrder,cc.defineGetterSetter(_p,"verticalFillOrder",_p.getVerticalFillOrder,_p.setVerticalFillOrder),_p=null,cc.TableView.create=function(dataSource,size,container){return new cc.TableView(dataSource,size,container)};